BEGIN NEW DATA CASE
C ------------------------------------------------------------------------------
C Generated by ATPDraw enero, 28, 2023
C from project C:\Users\aherrada\OneDrive - Universidad del Norte\Uninorte\Detec
C ATPDraw developed by H. K. Høidalen at NTNU - NORWAY 1999-2020
C ------------------------------------------------------------------------------
POWER FREQUENCY                      60.
C  dT  >< Tmax >< Xopt >< Copt ><Epsiln>
3.255E-5      .3     60.     60.        
     500       1       1       1       1       0       0       1       0
/TACS
TACS HYBRID
C Referencia Q desde terciario
98XX0031  =      0.0
98XX0032  =       1.
27XX0027
27XX0026
98XX0034  =       1.
C Referencia Q desde terciario
98XX0041  =      0.0
98XX0042  =       1.
27XX0036
27XX0035
98XX0044  =       1.
C Referencia Q desde terciario
98XX0051  =      0.0
98XX0052  =       1.
27XX0047
27XX0046
98XX0054  =       1.
C Referencia Q desde terciario
98XX0063  =      0.0
98XX0064  =       1.
27XX0058
27XX0057
98XX0066  =       1.
/MODELS
MODELS
INPUT
  MM0001 {v(X0084A)}
  MM0002 {v(X0084B)}
  MM0003 {v(X0084C)}
  MM0004 {i(X0084A)}
  MM0005 {i(X0084B)}
  MM0006 {i(X0084C)}
  MM0007 {v(R1A)}
  MM0008 {v(R1B)}
  MM0009 {v(R1C)}
  MM0010 {v(X0086A)}
  MM0011 {v(X0086B)}
  MM0012 {v(X0086C)}
  MM0013 {i(X0086A)}
  MM0014 {i(X0086B)}
  MM0015 {i(X0086C)}
  MM0016 {v(R2A)}
  MM0017 {v(R2B)}
  MM0018 {v(R2C)}
  MM0019 {v(X0088A)}
  MM0020 {v(X0088B)}
  MM0021 {v(X0088C)}
  MM0022 {i(X0088A)}
  MM0023 {i(X0088B)}
  MM0024 {i(X0088C)}
  MM0025 {v(R4A)}
  MM0026 {v(R4B)}
  MM0027 {v(R4C)}
  MM0028 {v(X0090A)}
  MM0029 {v(X0090B)}
  MM0030 {v(X0090C)}
  MM0031 {i(X0090A)}
  MM0032 {i(X0090B)}
  MM0033 {i(X0090C)}
  MM0034 {v(R5A)}
  MM0035 {v(R5B)}
  MM0036 {v(R5C)}
  MM0037 {v(X0092A)}
  MM0038 {v(X0092B)}
  MM0039 {v(X0092C)}
  MM0040 {i(X0092A)}
  MM0041 {i(X0092B)}
  MM0042 {i(X0092C)}
  MM0043 {v(R8A)}
  MM0044 {v(R8B)}
  MM0045 {v(R8C)}
  MM0046 {v(X0094A)}
  MM0047 {v(X0094B)}
  MM0048 {v(X0094C)}
  MM0049 {i(X0094A)}
  MM0050 {i(X0094B)}
  MM0051 {i(X0094C)}
  MM0052 {v(R9A)}
  MM0053 {v(R9B)}
  MM0054 {v(R9C)}
  MM0055 {v(X0096A)}
  MM0056 {v(X0096B)}
  MM0057 {v(X0096C)}
  MM0058 {i(X0096A)}
  MM0059 {i(X0096B)}
  MM0060 {i(X0096C)}
  MM0061 {v(R10A)}
  MM0062 {v(R10B)}
  MM0063 {v(R10C)}
  MM0064 {v(X0098A)}
  MM0065 {v(X0098B)}
  MM0066 {v(X0098C)}
  MM0067 {i(X0098A)}
  MM0068 {i(X0098B)}
  MM0069 {i(X0098C)}
  MM0070 {v(R22A)}
  MM0071 {v(R22B)}
  MM0072 {v(R22C)}
  MM0073 {v(X0100A)}
  MM0074 {v(X0100B)}
  MM0075 {v(X0100C)}
  MM0076 {i(X0100A)}
  MM0077 {i(X0100B)}
  MM0078 {i(X0100C)}
  MM0079 {v(R11A)}
  MM0080 {v(R11B)}
  MM0081 {v(R11C)}
  MM0082 {v(X0102A)}
  MM0083 {v(X0102B)}
  MM0084 {v(X0102C)}
  MM0085 {i(X0102A)}
  MM0086 {i(X0102B)}
  MM0087 {i(X0102C)}
  MM0088 {v(R12A)}
  MM0089 {v(R12B)}
  MM0090 {v(R12C)}
  MM0091 {v(X0104A)}
  MM0092 {v(X0104B)}
  MM0093 {v(X0104C)}
  MM0094 {i(X0104A)}
  MM0095 {i(X0104B)}
  MM0096 {i(X0104C)}
  MM0097 {v(R13A)}
  MM0098 {v(R13B)}
  MM0099 {v(R13C)}
  MM0100 {v(X0106A)}
  MM0101 {v(X0106B)}
  MM0102 {v(X0106C)}
  MM0103 {i(X0106A)}
  MM0104 {i(X0106B)}
  MM0105 {i(X0106C)}
  MM0106 {v(R14A)}
  MM0107 {v(R14B)}
  MM0108 {v(R14C)}
  MM0109 {v(X0108A)}
  MM0110 {v(X0108B)}
  MM0111 {v(X0108C)}
  MM0112 {i(X0108A)}
  MM0113 {i(X0108B)}
  MM0114 {i(X0108C)}
  MM0115 {v(R21A)}
  MM0116 {v(R21B)}
  MM0117 {v(R21C)}
  MM0118 {v(X0110A)}
  MM0119 {v(X0110B)}
  MM0120 {v(X0110C)}
  MM0121 {i(X0110A)}
  MM0122 {i(X0110B)}
  MM0123 {i(X0110C)}
  MM0124 {v(R15A)}
  MM0125 {v(R15B)}
  MM0126 {v(R15C)}
  MM0127 {v(X0112A)}
  MM0128 {v(X0112B)}
  MM0129 {v(X0112C)}
  MM0130 {i(X0112A)}
  MM0131 {i(X0112B)}
  MM0132 {i(X0112C)}
  MM0133 {v(R16A)}
  MM0134 {v(R16B)}
  MM0135 {v(R16C)}
  MM0136 {v(X0114A)}
  MM0137 {v(X0114B)}
  MM0138 {v(X0114C)}
  MM0139 {i(X0114A)}
  MM0140 {i(X0114B)}
  MM0141 {i(X0114C)}
  MM0142 {v(R17A)}
  MM0143 {v(R17B)}
  MM0144 {v(R17C)}
  MM0145 {v(X0116A)}
  MM0146 {v(X0116B)}
  MM0147 {v(X0116C)}
  MM0148 {i(X0116A)}
  MM0149 {i(X0116B)}
  MM0150 {i(X0116C)}
  MM0151 {v(R18A)}
  MM0152 {v(R18B)}
  MM0153 {v(R18C)}
  MM0154 {v(X0118A)}
  MM0155 {v(X0118B)}
  MM0156 {v(X0118C)}
  MM0157 {i(X0118A)}
  MM0158 {i(X0118B)}
  MM0159 {i(X0118C)}
  MM0160 {v(R23A)}
  MM0161 {v(R23B)}
  MM0162 {v(R23C)}
  MM0163 {v(X0120A)}
  MM0164 {v(X0120B)}
  MM0165 {v(X0120C)}
  MM0166 {i(X0120A)}
  MM0167 {i(X0120B)}
  MM0168 {i(X0120C)}
  MM0169 {v(R24A)}
  MM0170 {v(R24B)}
  MM0171 {v(R24C)}
  MM0172 {v(X0122A)}
  MM0173 {v(X0122B)}
  MM0174 {v(X0122C)}
  MM0175 {i(X0122A)}
  MM0176 {i(X0122B)}
  MM0177 {i(X0122C)}
  MM0178 {v(R25A)}
  MM0179 {v(R25B)}
  MM0180 {v(R25C)}
  MM0181 {v(X0124A)}
  MM0182 {v(X0124B)}
  MM0183 {v(X0124C)}
  MM0184 {i(X0124A)}
  MM0185 {i(X0124B)}
  MM0186 {i(X0124C)}
  MM0187 {v(R7A)}
  MM0188 {v(R7B)}
  MM0189 {v(R7C)}
  MM0190 {v(X0126A)}
  MM0191 {v(X0126B)}
  MM0192 {v(X0126C)}
  MM0193 {i(X0126A)}
  MM0194 {i(X0126B)}
  MM0195 {i(X0126C)}
  MM0196 {v(R6A)}
  MM0197 {v(R6B)}
  MM0198 {v(R6C)}
  MM0199 {v(X0128A)}
  MM0200 {v(X0128B)}
  MM0201 {v(X0128C)}
  MM0202 {i(X0128A)}
  MM0203 {i(X0128B)}
  MM0204 {i(X0128C)}
  MM0205 {v(R20A)}
  MM0206 {v(R20B)}
  MM0207 {v(R20C)}
  MM0208 {v(X0030A)}
  MM0209 {v(X0030B)}
  MM0210 {v(X0030C)}
  MM0211 {tacs(XX0031)}
  MM0215 {tacs(XX0032)}
  MM0216 {tacs(XX0034)}
  MM0217 {i(X0028A)}
  MM0218 {i(X0028B)}
  MM0219 {i(X0028C)}
  MM0223 {tacs(XX0027)}
  MM0224 {tacs(XX0026)}
  MM0231 {v(X0040A)}
  MM0232 {v(X0040B)}
  MM0233 {v(X0040C)}
  MM0234 {i(X0040A)}
  MM0235 {i(X0040B)}
  MM0236 {i(X0040C)}
  MM0237 {tacs(XX0041)}
  MM0241 {tacs(XX0042)}
  MM0242 {tacs(XX0044)}
  MM0243 {i(X0037A)}
  MM0244 {i(X0037B)}
  MM0245 {i(X0037C)}
  MM0249 {tacs(XX0036)}
  MM0250 {tacs(XX0035)}
  MM0257 {v(X0050A)}
  MM0258 {v(X0050B)}
  MM0259 {v(X0050C)}
  MM0260 {i(X0050A)}
  MM0261 {i(X0050B)}
  MM0262 {i(X0050C)}
  MM0263 {tacs(XX0051)}
  MM0267 {tacs(XX0052)}
  MM0268 {tacs(XX0054)}
  MM0269 {i(X0048A)}
  MM0270 {i(X0048B)}
  MM0271 {i(X0048C)}
  MM0275 {tacs(XX0047)}
  MM0276 {tacs(XX0046)}
  MM0283 {v(X0062A)}
  MM0284 {v(X0062B)}
  MM0285 {v(X0062C)}
  MM0286 {i(X0062A)}
  MM0287 {i(X0062B)}
  MM0288 {i(X0062C)}
  MM0289 {tacs(XX0063)}
  MM0293 {tacs(XX0064)}
  MM0294 {tacs(XX0066)}
  MM0295 {i(X0059A)}
  MM0296 {i(X0059B)}
  MM0297 {i(X0059C)}
  MM0301 {tacs(XX0058)}
  MM0302 {tacs(XX0057)}
  MM0309 {i(R1A)}
  MM0310 {i(R1B)}
  MM0311 {i(R1C)}
  MM0312 {v(X0069A)}
  MM0313 {v(X0069B)}
  MM0314 {v(X0069C)}
  MM0315 {i(X0069A)}
  MM0316 {i(X0069B)}
  MM0317 {i(X0069C)}
  MM0318 {v(X0174A)}
  MM0319 {v(X0174B)}
  MM0320 {v(X0174C)}
  MM0321 {i(X0174A)}
  MM0322 {i(X0174B)}
  MM0323 {i(X0174C)}
  MM0324 {v(R19A)}
  MM0325 {v(R19B)}
  MM0326 {v(R19C)}
  MM0327 {v(X0176A)}
  MM0328 {v(X0176B)}
  MM0329 {v(X0176C)}
  MM0330 {i(X0176A)}
  MM0331 {i(X0176B)}
  MM0332 {i(X0176C)}
  MM0333 {v(R3A)}
  MM0334 {v(R3B)}
  MM0335 {v(R3C)}
  MM0336 {v(N124A)}
  MM0337 {v(N124B)}
  MM0338 {v(N124C)}
  MM0339 {i(N124A)}
  MM0340 {i(N124B)}
  MM0341 {i(N124C)}
OUTPUT
  X0033A
  X0033B
  X0033C
  XX0026
  XX0027
  XX0135
  X0138A
  X0138B
  X0136A
  X0136B
  X0137A
  X0137B
  X0139A
  X0139B
  X0134A
  X0134B
  X0029A
  X0029B
  X0029C
  PDER3
  QDER3
  X0043A
  X0043B
  X0043C
  XX0035
  XX0036
  XX0146
  X0149A
  X0149B
  X0147A
  X0147B
  X0148A
  X0148B
  X0150A
  X0150B
  X0145A
  X0145B
  X0038A
  X0038B
  X0038C
  PDER2
  QDER2
  X0053A
  X0053B
  X0053C
  XX0046
  XX0047
  XX0157
  X0160A
  X0160B
  X0158A
  X0158B
  X0159A
  X0159B
  X0161A
  X0161B
  X0156A
  X0156B
  X0049A
  X0049B
  X0049C
  PDER4
  QDER4
  X0065A
  X0065B
  X0065C
  XX0057
  XX0058
  XX0168
  X0171A
  X0171B
  X0169A
  X0169B
  X0170A
  X0170B
  X0172A
  X0172B
  X0167A
  X0167B
  X0060A
  X0060B
  X0060C
  PSUB
  QSUB
  PSYNC
  QSYN
  XX0014
  XX0076
MODEL WRITEPROBEI
comment--------------------------------------------------------------
Calculates the phasor of input V and I with FFT Radix2-8 algorithm.
The phasor is written to the LIS-file at the specified TIME.
SampleFreq should be a whole multiple of the 8* power frequency.
-----------------------------------------------------------endcomment
DATA  
  N {DFLT:3}           --number of phases
  FREQ {DFLT:50}       --power frequency
  TIME {DFLT:0}        --sample time
  SampleFreq {dflt:400}--sample freq
  IDX
INPUT 
  V[1..N], I[1..N]     --input signal to be transformed
VAR    
  P[1..N], Q[1..N], 
Imagn[1..N],Iangl[1..N],reV[1..N],imV[1..N],reI[1..N],imI[1..N],OMEGA,
  k,alpha,x1,x3,x5,x7,xre,xim,delta_T[0..7],written

HISTORY
  V[1..N] {DFLT:0}
  I[1..N] {DFLT:0}
timestep min: recip(SampleFreq)
DELAY CELLS (V[1..N]) : recip(FREQ*timestep)+2
DELAY CELLS (I[1..N]) : recip(FREQ*timestep)+2

INIT 
  OMEGA:= 2*PI*FREQ
  written:=0
  reV[1..N] :=0
  imV[1..N] :=0
  reI[1..N] :=0
  imI[1..N] :=0
  alpha:=1/sqrt(2)
  for k:= 0 to 7 do
    delta_T[k] := k*recip(FREQ*8)
  endfor
ENDINIT
EXEC
  if written=0 then
    if (FREQ>0) and (t>=TIME-recip(FREQ)) then
      for k:=1 to N do
        x1 := delay(V[k],delta_T[0],1) - delay(V[k],delta_T[4],1)
        x3 := delay(V[k],delta_T[2],1) - delay(V[k],delta_T[6],1)
        x5 := delay(V[k],delta_T[1],1) - delay(V[k],delta_T[5],1)
        x7 := delay(V[k],delta_T[3],1) - delay(V[k],delta_T[7],1)
        xRe := x1 + (x5 - x7)*alpha
        xIm := x3 + (x5 + x7)*alpha
        ReV[k] := (xRe*cos(OMEGA*T)+xIm*sin(OMEGA*T))/4
        ImV[k] := (xIm*cos(OMEGA*T)-xRe*sin(OMEGA*T))/4
        x1 := delay(I[k],delta_T[0],1) - delay(I[k],delta_T[4],1)
        x3 := delay(I[k],delta_T[2],1) - delay(I[k],delta_T[6],1)
        x5 := delay(I[k],delta_T[1],1) - delay(I[k],delta_T[5],1)
        x7 := delay(I[k],delta_T[3],1) - delay(I[k],delta_T[7],1)
        xRe := x1 + (x5 - x7)*alpha
        xIm := x3 + (x5 + x7)*alpha
        ReI[k] := (xRe*cos(OMEGA*T)+xIm*sin(OMEGA*T))/4
        ImI[k] := (xIm*cos(OMEGA*T)-xRe*sin(OMEGA*T))/4
      endfor
    endif 
    if t>=TIME then
      if FREQ>0 then
        for k:=1 to N do
          P[k]:=(reV[k]*reI[k]+imV[k]*imI[k])/2
          Q[k]:=(imV[k]*reI[k]-reV[k]*imI[k])/2
          Imagn[k]:=sqrt(reI[k]**2+imI[k]**2)
          if (imI[k]=0) and (reI[k]=0) then
            Iangl[k]:=0
          else
            Iangl[k]:=atan2(imI[k],reI[k])*180/PI
          endif
        endfor 
      else
        for k:=1 to N do
          P[k]:=I[k]*V[k]/2
          Q[k]:=0
          Imagn[k]:=I[k]
          Iangl[k]:=0
        endfor
      endif
      write('BEGIN WRITE @WRITEPROBEI',trunc(Idx))    --Do not modify this line, replaced by ATPDraw
      for k:=1 to N do
        write(Imagn[k],' ', Iangl[k],' ', P[k],' ' ,Q[k],' ' , TIME)            
            --Add multiple columns or multiple lines 
      endfor
      write('END WRITE @WRITEPROBEI',trunc(Idx))      --Do not modify this line, replaced by ATPDraw
      written:=1
    endif
  endif
ENDEXEC
ENDMODEL
MODEL WRITEPROBEV
comment---------------------------------------------------------
Calculates the phasor of input V with FFT Radix2-8 algorithm.
The phasor is written to the LIS-file at the specified TIME.
SampleFreq should be a whole multiple of the 8* power frequency.
-------------------------------------------------------endcomment
DATA  
  N {DFLT:3}           --number of phases
  FREQ {DFLT:50}       --power frequency
  TIME {DFLT:0}        --sample time
  SampleFreq {dflt:400}--sample freq
  IDX
INPUT 
  V[1..N]     --input signal to be transformed
VAR    
  Vmagn[1..N],Vangl[1..N],reV[1..N],imV[1..N],OMEGA,
  k,alpha,x1,x3,x5,x7,xre,xim,delta_T[0..7],written

HISTORY
  V[1..N] {DFLT:0}
timestep min: recip(SampleFreq)
DELAY CELLS (V[1..N]) : recip(FREQ*timestep)+2

INIT 
  OMEGA:= 2*PI*FREQ
  written:=0
  reV[1..N] :=0
  imV[1..N] :=0
  alpha:=1/sqrt(2)
  for k:= 0 to 7 do
    delta_T[k] := k*recip(FREQ*8)
  endfor
ENDINIT
EXEC
  if written=0 then
    if (FREQ>0) and (t>=TIME-recip(FREQ)) then
      for k:=1 to N do
        x1 := delay(V[k],delta_T[0],1) - delay(V[k],delta_T[4],1)
        x3 := delay(V[k],delta_T[2],1) - delay(V[k],delta_T[6],1)
        x5 := delay(V[k],delta_T[1],1) - delay(V[k],delta_T[5],1)
        x7 := delay(V[k],delta_T[3],1) - delay(V[k],delta_T[7],1)
        xRe := x1 + (x5 - x7)*alpha
        xIm := x3 + (x5 + x7)*alpha
        ReV[k] := (xRe*cos(OMEGA*T)+xIm*sin(OMEGA*T))/4
        ImV[k] := (xIm*cos(OMEGA*T)-xRe*sin(OMEGA*T))/4
      endfor
    endif 
    if t>=TIME then
      if FREQ>0 then
        for k:=1 to N do
          Vmagn[k]:=sqrt(reV[k]**2+imV[k]**2)
          if (imV[k]=0) and (reV[k]=0) then
            Vangl[k]:=0
          else
            Vangl[k]:=atan2(imV[k],reV[k])*180/PI
          endif
        endfor 
      else
        for k:=1 to N do
          Vmagn[k]:=V[k]
          Vangl[k]:=0
        endfor
      endif
      write('BEGIN WRITE @WRITEPROBEV',trunc(Idx))    --Do not modify this line, replaced by ATPDraw
      for k:=1 to N do
        write(Vmagn[k],' ', Vangl[k],' ', TIME)                        --Add multiple columns or multiple lines 
      endfor
      write('END WRITE @WRITEPROBEV',trunc(Idx))      --Do not modify this line, replaced by ATPDraw
      written:=1
    endif
  endif
ENDEXEC
ENDMODEL
MODEL ABC2RMS
comment------------------------------------------------------------------
Calculates the true rms value of a 3-phase signal based on integration.
SampleFreq frequency should be whole multiple of power frequency.
---------------------------------------------------------------endcomment
DATA   
  freq          -- base frequency
  xrms_ini {dflt:-1} -- initial rms value
  scale {dflt:1} --multiply output by this number 
  SampleFreq     -- sample frequency in Hz
INPUT  
  x[1..3]        -- monitored signal
OUTPUT 
  xrms[1..3]     -- rms value of monitored signal
VAR    
  xrms[1..3]     
  x2[1..3]       -- internal, x*x
  ix2[1..3]      -- internal, integral of x2
  period         -- 1/freq
  n
TIMESTEP min:recip(SampleFreq) --this restricts local timestep to avoid overflow
DELAY CELLS(ix2[1..3]): recip(freq*timestep) +2
INIT
  period       := recip(freq)
  histdef(ix2[1..3]) := 0
  integral(x2[1..3]) := 0
  IF xrms_ini <0 THEN xrms[1..3]:=0 ELSE xrms[1..3]:=xrms_ini ENDIF
ENDINIT
EXEC
  FOR n:=1 TO 3 DO
    x2[n]  := x[n]*x[n]
    ix2[n] := integral(x2[n])
    IF t>period THEN
      xrms[n] := sqrt((ix2[n] - delay(ix2[n], period))*freq)*scale
    ENDIF
  ENDFOR
ENDEXEC
ENDMODEL
MODEL PF
--Grid code requirements regarding 
DATA ILIM0 {DFLT:1.2}
INPUT Qref,VIN[1..3]        --QREF DEL CONTROL TERCIARIO, VIN RMS
      Pref, Pava            --PREF DEL CTRL TERCIARIO y P disponible en primary source
OUTPUT IQMIN, PMAX    --LA MINIMA Q PARA CUMPLIR PF Y LA MAXIMA P HABILITADA

VAR IQMIN, IDMAX, V, ILIM, PMAX --IDMAX es la maxima permitida minimo de varias

INIT
  IQMIN:=0
  IDMAX:=1
  V:=1
  ILIM:=1.2
  PMAX:=0
ENDINIT

EXEC
V:=MIN(VIN[1],VIN[2],VIN[3])

ILIM:=ILIM0

--COMO SE TRABAJA EN POR UNIDAD, IQ ES IGUAL A Qref
IF V<=0.5 THEN
    IF ABS(Qref)<ILIM*0.9  THEN   --si ref de Q menor a 0.9 Imax
        IQMIN:=0.95*ILIM        --POSITIVO PARA GENERAR REACTIVOS
    ELSE
        IQMIN:=ABS(Qref) --GARANTIZA GENERACION, PUES REFERENCIA PUEDE SER NEGATIVA
    ENDIF
    
ELSIF AND(V>0.5, V<=0.85) THEN
    IF ABS(Qref)<(-(18/7)*V + 153/70)*ILIM THEN
        IQMIN:=(-(18/7)*V + 153/70)*ILIM    
    ELSE
        IQMIN:=ABS(Qref)
    ENDIF
    
ELSIF AND(V>0.85, V<=0.9)  THEN
    IF Qref<0   THEN
        IQMIN:=0
    ELSE
        IQMIN:=Qref
    ENDIF
    
ELSE
    IQMIN:=Qref        --si la tensión es mayor a 0.9, se genera/consume lo que se pida
ENDIF


--segundo if para id, en este caso se encuentra el valor máximo de id
--que se permite
IF V<=0.85 THEN
    IDMAX:=SQRT(abs(ILIM)**2 - abs(IQMIN)**2)
    
ELSE
    IDMAX:=1
ENDIF

PMAX:=MIN(IDMAX,Pava,Pref)


ENDEXEC
ENDMODEL
MODEL PLLDQ
COMMENT =============================================================

    EEUG Course 2005:
    Estimation of frequency and phase by means of a PLL which
    operates using dq-components of measured voltages
    Reference: C. Zan; C. Fitzer; V. K. Ramachandaramurthy; 
    A. Arulampalam; M. Barnes; N. Jenkins: 
    Software Phased-Locked Loop applied to Dynamic Voltage 
    Restorer (DVR), Proc. IEEE-PES Winter Meeting 2001, 
    pp. 1033-1038.

    14-Aug-2005, Prof. M. Kizilcay
========================================================== ENDCOMMENT
INPUT  u[1..3]              -- phase voltages
OUTPUT FREQ
CONST
  twopi  {VAL:6.283185307}
DATA
  theta0 {DFLT:0.0}          -- phase betw. d-axis and alpha-axis
  f0     {DFLT:50.0}
  Gain   {DFLT:22.85}
VAR
  ualpha, ubeta, u0, ualfaN, ubetaN,
  u_dN, u_qN, u_d, u_q, uampl
  theta, wcon 
  omega, omega0,freq 
  ucomp, temp
HISTORY
  wcon {DFLT:0}
  u_qN {DFLT:0}
  omega {DFLT:2*PI*f0}
  INTEGRAL(omega) {DFLT:theta0*PI/180}
  freq {DFLT:50}
  theta {DFLT:theta0*PI/180}
INIT
  omega0 := 2*PI*f0
  theta := theta0*PI/180.0
ENDINIT
EXEC
  -- From three-phase to alfa-beta-zero
  ualpha := SQRT(2/3)*(u[1] - 0.5*(u[2]+u[3]))
  ubeta := SQRT(0.5)*(u[2] - u[3])
  u0 := (u[1] + u[2] + u[3])/3.0
  temp := RECIP(SQRT(ualpha*ualpha+ubeta*ubeta))
  ualfaN := ualpha*temp
  ubetaN := ubeta*temp
  -- From alfa-beta to d-q (with constant frequency)
  u_d := SQRT(2/3)*(ualpha*cos(theta) + ubeta*sin(theta))
  u_q := SQRT(2/3)*(-ualpha*sin(theta) + ubeta*cos(theta))
  uampl := SQRT(u_d*u_d+u_q*u_q)
  u_dN := ualfaN*cos(theta) + ubetaN*sin(theta)
  COMBINE ITERATE AS theta_comp
    u_qN := -ualfaN*sin(theta) + ubetaN*cos(theta)
    -- Phase-locked loop follows phase angle of the source
    CLAPLACE(wcon/u_qN) := (Gain|s0 + 0.001242|s1)/(1.0|s0 + 0.02315|s1)
    --CLAPLACE(wcon/u_qN) := (Gain|s0 + 4.0|s1)/(0.0|s0 + 1.0|s1)
    omega := omega0 + wcon
    theta := INTEGRAL(omega)
  ENDCOMBINE
  FREQ := omega/twopi
  ucomp := uampl*cos(theta)
ENDEXEC
ENDMODEL
MODEL DQ_I
INPUT In[1..3],f
OUTPUT DQ[1..2]
DATA Vnom,Pnom
VAR DQ[1..2],I[1..3],wt
CONST th0{val:0}
INIT
  DQ[1]:=1
  DQ[2]:=0
  wt:=0
  I[1..3]:=0
ENDINIT
EXEC
  I[1]:=In[1]/(sqrt(2/3)*Pnom/Vnom)    --S=sqrt(3)*V*I, en Y Ilinea=Ifase
  I[2]:=In[2]/(sqrt(2/3)*Pnom/Vnom)
  I[3]:=In[3]/(sqrt(2/3)*Pnom/Vnom)  
  wt:=2.*pi*(f)*t
--Park transforms
  DQ[1]:=(2./3.)*(I[1]*cos(wt+th0)+I[2]*cos(wt+th0-2*pi/3)+I[3]*cos(wt+th0+2*pi/
3)) 
  DQ[2]:=(-2./3.)*(I[1]*sin(wt+th0)+I[2]*sin(wt+th0-2*pi/3)+I[3]*sin(wt+th0+2*
pi/3))
ENDEXEC
ENDMODEL
MODEL DQ_V
INPUT VIn[1..3],f
OUTPUT DQ[1..2]
DATA Vnom
VAR DQ[1..2],V[1..3],wt
CONST th0{val:0}
INIT
  DQ[1]:=1
  DQ[2]:=0
  wt:=0
  V[1..3]:=0
ENDINIT
EXEC
  V[1]:=VIn[1]/(Vnom*sqrt(2./3.))
  V[2]:=VIn[2]/(Vnom*sqrt(2./3.)) 
  V[3]:=VIn[3]/(Vnom*sqrt(2./3.))  
  wt:=2.*pi*(f)*t
--Park transforms
  DQ[1]:=(2./3.)*(V[1]*cos(wt+th0)+V[2]*cos(wt+th0-2*pi/3)+V[3]*cos(wt+th0+2*pi/
3)) 
  DQ[2]:=(-2./3.)*(V[1]*sin(wt+th0)+V[2]*sin(wt+th0-2*pi/3)+V[3]*sin(wt+th0+2*
pi/3))

ENDEXEC
ENDMODEL
MODEL Outer3
COMMENT
OUTER LOOP PARA CASO CONECTADO Y POR MEDIO DE COMPONENTES DQ
ENDCOMMENT

INPUT Vdq[1..2],Pref,Qref
--Vdq medido

DATA ILIM {DFLT:1.2}

OUTPUT Idq[1..2]
--Idq para usar como referencias de inner loop
VAR Idq[1..2], Idmax2, Idmax
INIT
  Idq[1]:=Pref
  Idq[2]:=Qref
ENDINIT
EXEC
  Idq[1]:=(Vdq[1]*Pref + Vdq[2]*Qref)*recip(Vdq[1]*Vdq[1]+Vdq[2]*Vdq[2])
  Idq[2]:=(Vdq[2]*Pref - Vdq[1]*Qref)*recip(Vdq[1]*Vdq[1]+Vdq[2]*Vdq[2])
  
    comment
if Idq[1]>1.2 then
     Idq[1]:=1.2
elsif Idq[1]<-1.2 then
     Idq[1]:=-1.2
endif
    endcomment
    
if Idq[2]>ILIM then
     Idq[2]:=ILIM
elsif Idq[2]<-ILIM then
     Idq[2]:=-ILIM
endif


--function Idref=Idq[1]= fcn(Id=Idq[1],Iqmeas=Idq[2],Imax=1.2)

Idmax2 := ILIM**2 - Idq[2]**2
if Idmax2<0.01 then   --si la generacion permitida de P es menor a 0.1, mejor no genere.
    Idmax:=0
else
    Idmax:=sqrt(Idmax2)
endif

if AND(Idq[1]<=Idmax, Idq[1]>=-Idmax) then
    Idq[1]:=Idq[1]   --si esto se cumple, la anterior es la definitiva
else
    Idq[1]:=Idmax
endif

if (abs(Idq[1])<=abs(Idmax)) then
    Idq[1]:=Idq[1]
elsif Idq[1]>Idmax  then
    Idq[1]:=Idmax
elsif Idq[1]<-Idmax  then
    Idq[1]:=-Idmax
endif

ENDEXEC
ENDMODEL
MODEL INNER
DATA Rf,Lf,Pnom,Vnom,Kp,Ki
INPUT Vdq_m[1..2],Idq_m[1..2],Idq_r[1..2]
OUTPUT Vdq_r[1..2],Vdq_pu[1..2]    --Salida del inner es Vref para el VSC
VAR Vdq_r[1..2],Vdq_pu[1..2],Id,Iq,ErrorId,ErrorIq,Zbase

INIT
Zbase:=Vnom*Vnom/Pnom
Vdq_pu[1]:=1
Vdq_pu[2]:=0
Vdq_r[1]:=1
Vdq_r[2]:=0
histdef(Id):=0
histdef(Iq):=0
ErrorId:=0
ErrorIq:=0
ENDINIT

EXEC
  ErrorId:=Idq_r[1]-Idq_m[1]
  
  laplace(Id/ErrorId):= (Ki|s0+Kp|s1)/(1|s1) -- out=in*(KpS+Ki)/S
  Vdq_pu[1]:=Id+Vdq_m[1] + Idq_m[1]*Rf/Zbase - Idq_m[2]*(2*pi*60*Lf)/Zbase

  ErrorIq:=Idq_r[2]-Idq_m[2]
  laplace(Iq/ErrorIq):= (Ki|s0+Kp|s1)/(1|s1) -- out=in*1/(1+10*s)
  Vdq_pu[2]:=Iq+Vdq_m[2] + Idq_m[2]*Rf/Zbase + Idq_m[1]*(2*pi*60*Lf)/Zbase

  Vdq_r[1]:=Vdq_pu[1]*Vnom*sqrt(2/3)
  Vdq_r[2]:=Vdq_pu[2]*Vnom*sqrt(2/3)
ENDEXEC

ENDMODEL
MODEL DQ_Inv
INPUT DQ[1..2],f
OUTPUT abc[1..3]
VAR abc[1..3],wt
CONST th0 {val:0}

INIT
  abc[1..3]:=0
  wt:=0
ENDINIT

EXEC
wt:=2.*pi*(f)*t
--Park transforms
  abc[1]:=DQ[1]*cos(wt+th0)-DQ[2]*sin(wt+th0)
  abc[2]:=DQ[1]*cos(wt+th0-2*pi/3)-DQ[2]*sin(wt+th0-2*pi/3)
  abc[3]:=DQ[1]*cos(wt+th0+2*pi/3)-DQ[2]*sin(wt+th0+2*pi/3)
ENDEXEC
ENDMODEL
MODEL UI2PQ3
COMMENT-------------------------------------------------------------------------
Calculates the input active and reactive power of time domain voltage/current 
signals by a user selectable algorithm. Fixed frequency.
Output in 3-phase VA quantities. Downsampling approach ala COMTRADE component.
Algorithm=0: 8-point RADIX-2 FFT algorithm.
Algorithm=1: Recursive DFT algorithm. HKH Apr. 2021.
Algorithm=2: alpha-beta transformation by Peñaloza
----------------------------------------------------------------------ENDCOMMENT
INPUT 
  V[1..3], I[1..3]     --input signals to be transformed to phasors and power
DATA  
  FREQ {DFLT:50}       --power frequency
  SampleFreq {dflt:400}--sample frequency in this model in Hz
  ScaleV {dflt:1}      --multiply output by this number 
  ScaleI {dflt:1}      --multiply output by this number
  Algorithm {dflt:0}   --0: FFT radix2-8, 1: DFT recursive
OUTPUT 
  P, Q     --Active and reactive power output signals (rms)
VAR    
  P,Q,reV[1..3],imV[1..3],reI[1..3],imI[1..3],OMEGA,D,alpha,x1,x3,x5,x7,
  Ti,dt,DTi, xre,xim,n,delta_T[0..7],
  P3A,Q3A,P3I,Q3I,DP3,DQ3,VAT,IAT,VBT,IBT,Period
CONST SQR3 {VAL:1.732050807569}
HISTORY
  V[1..3] {DFLT:0}
  I[1..3] {DFLT:0}
  P3A {DFLT: 0.0}, Q3A {DFLT: 0.0}
  P3I {DFLT: 0.0}, Q3I {DFLT: 0.0}
DELAY CELLS (V[1..3]) : recip(FREQ*timestep)+2
DELAY CELLS (I[1..3]) : recip(FREQ*timestep)+2
DELAY CELLS (P3I, Q3I): recip(FREQ*timestep)+2

INIT 
  OMEGA:= 2*PI*FREQ
  reV[1..3] :=0
  imV[1..3] :=0
  reI[1..3] :=0
  imI[1..3] :=0
  alpha:=1/sqrt(2)
  for n:= 0 to 7 do
    delta_T[n] := n/(FREQ*8)
  endfor
  Period:=recip(FREQ)
  dt:=recip(SampleFreq)
  Ti:=0
ENDINIT
EXEC
  DTi:=T-Ti
  if DTi>=0
  then
    if Algorithm=2
    then
      VAT := (2.0*V[1] - V[2] - V[3])/SQR3
      IAT := (2.0*I[1] - I[2] - I[3])/SQR3
      VBT := V[2] - V[3]
      IBT := I[2] - I[3]
      P3I := (VAT*IAT + VBT*IBT)/2.0*ScaleV*ScaleI
      Q3I := (VBT*IAT - VAT*IBT)/2.0*ScaleV*ScaleI
      P3A := P3A + (delay(P3I, DTi, 2) - delay(P3I, Period+DTi, 2))*dt*FREQ
      Q3A := Q3A + (delay(Q3I, DTi, 2) - delay(Q3I, Period+DTi, 2))*dt*FREQ
      P := P3I*(Ti<=Period) + P3A*(Ti>Period)
      Q := Q3I*(Ti<=Period) + Q3A*(Ti>Period)
    else
      P:=0
      Q:=0
      for n:=1 to 3 do
        if Algorithm=0
        then
          x1 := delay(V[n],delta_T[0]+DTi,2) - delay(V[n],delta_T[4]+DTi,2)
          x3 := delay(V[n],delta_T[2]+DTi,2) - delay(V[n],delta_T[6]+DTi,2)
          x5 := delay(V[n],delta_T[1]+DTi,2) - delay(V[n],delta_T[5]+DTi,2)
          x7 := delay(V[n],delta_T[3]+DTi,2) - delay(V[n],delta_T[7]+DTi,2)
          xRe := x1 + (x5 - x7)*alpha
          xIm := x3 + (x5 + x7)*alpha
          ReV[n] := (xRe*cos(OMEGA*Ti)+xIm*sin(OMEGA*Ti))/4
          ImV[n] := (xIm*cos(OMEGA*Ti)-xRe*sin(OMEGA*Ti))/4
          x1 := delay(I[n],delta_T[0]+DTi,2) - delay(I[n],delta_T[4]+DTi,2)
          x3 := delay(I[n],delta_T[2]+DTi,2) - delay(I[n],delta_T[6]+DTi,2)
          x5 := delay(I[n],delta_T[1]+DTi,2) - delay(I[n],delta_T[5]+DTi,2)
          x7 := delay(I[n],delta_T[3]+DTi,2) - delay(I[n],delta_T[7]+DTi,2)
          xRe := x1 + (x5 - x7)*alpha
          xIm := x3 + (x5 + x7)*alpha
          ReI[n] := (xRe*cos(OMEGA*Ti)+xIm*sin(OMEGA*Ti))/4
          ImI[n] := (xIm*cos(OMEGA*Ti)-xRe*sin(OMEGA*Ti))/4
        else
          D:=2*FREQ*dt*(delay(V[n],DTi,2)-delay(V[n],Period+DTi,2)) 
          ReV[n]:=ReV[n]+D*cos(OMEGA*Ti)
          ImV[n]:=ImV[n]-D*sin(OMEGA*Ti)
          D:=2*FREQ*dt*(delay(I[n],DTi,2)-delay(I[n],Period+DTi,2))
          ReI[n]:=ReI[n]+D*cos(OMEGA*Ti)
          ImI[n]:=ImI[n]-D*sin(OMEGA*Ti)
        endif
        P:=P+(reV[n]*reI[n]+imV[n]*imI[n])*ScaleV*ScaleI/2
        Q:=Q+(imV[n]*reI[n]-reV[n]*imI[n])*ScaleV*ScaleI/2
      endfor
    endif
    Ti:=Ti+dt
  endif  
ENDEXEC
ENDMODEL
USE WRITEPROBEI AS M1
INPUT
  V[1]:= MM0001
  V[2]:= MM0002
  V[3]:= MM0003
  I[1]:= MM0004
  I[2]:= MM0005
  I[3]:= MM0006
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       1.
ENDUSE
USE WRITEPROBEV AS M2
INPUT
  V[1]:= MM0007
  V[2]:= MM0008
  V[3]:= MM0009
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       2.
ENDUSE
USE WRITEPROBEI AS M3
INPUT
  V[1]:= MM0010
  V[2]:= MM0011
  V[3]:= MM0012
  I[1]:= MM0013
  I[2]:= MM0014
  I[3]:= MM0015
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       3.
ENDUSE
USE WRITEPROBEV AS M4
INPUT
  V[1]:= MM0016
  V[2]:= MM0017
  V[3]:= MM0018
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       4.
ENDUSE
USE WRITEPROBEI AS M5
INPUT
  V[1]:= MM0019
  V[2]:= MM0020
  V[3]:= MM0021
  I[1]:= MM0022
  I[2]:= MM0023
  I[3]:= MM0024
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       5.
ENDUSE
USE WRITEPROBEV AS M6
INPUT
  V[1]:= MM0025
  V[2]:= MM0026
  V[3]:= MM0027
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       6.
ENDUSE
USE WRITEPROBEI AS M7
INPUT
  V[1]:= MM0028
  V[2]:= MM0029
  V[3]:= MM0030
  I[1]:= MM0031
  I[2]:= MM0032
  I[3]:= MM0033
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       7.
ENDUSE
USE WRITEPROBEV AS M8
INPUT
  V[1]:= MM0034
  V[2]:= MM0035
  V[3]:= MM0036
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       8.
ENDUSE
USE WRITEPROBEI AS M9
INPUT
  V[1]:= MM0037
  V[2]:= MM0038
  V[3]:= MM0039
  I[1]:= MM0040
  I[2]:= MM0041
  I[3]:= MM0042
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=       9.
ENDUSE
USE WRITEPROBEV AS M10
INPUT
  V[1]:= MM0043
  V[2]:= MM0044
  V[3]:= MM0045
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      10.
ENDUSE
USE WRITEPROBEI AS M11
INPUT
  V[1]:= MM0046
  V[2]:= MM0047
  V[3]:= MM0048
  I[1]:= MM0049
  I[2]:= MM0050
  I[3]:= MM0051
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      11.
ENDUSE
USE WRITEPROBEV AS M12
INPUT
  V[1]:= MM0052
  V[2]:= MM0053
  V[3]:= MM0054
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      12.
ENDUSE
USE WRITEPROBEI AS M13
INPUT
  V[1]:= MM0055
  V[2]:= MM0056
  V[3]:= MM0057
  I[1]:= MM0058
  I[2]:= MM0059
  I[3]:= MM0060
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      13.
ENDUSE
USE WRITEPROBEV AS M14
INPUT
  V[1]:= MM0061
  V[2]:= MM0062
  V[3]:= MM0063
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      14.
ENDUSE
USE WRITEPROBEI AS M15
INPUT
  V[1]:= MM0064
  V[2]:= MM0065
  V[3]:= MM0066
  I[1]:= MM0067
  I[2]:= MM0068
  I[3]:= MM0069
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      15.
ENDUSE
USE WRITEPROBEV AS M16
INPUT
  V[1]:= MM0070
  V[2]:= MM0071
  V[3]:= MM0072
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      16.
ENDUSE
USE WRITEPROBEI AS M17
INPUT
  V[1]:= MM0073
  V[2]:= MM0074
  V[3]:= MM0075
  I[1]:= MM0076
  I[2]:= MM0077
  I[3]:= MM0078
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      17.
ENDUSE
USE WRITEPROBEV AS M18
INPUT
  V[1]:= MM0079
  V[2]:= MM0080
  V[3]:= MM0081
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      18.
ENDUSE
USE WRITEPROBEI AS M19
INPUT
  V[1]:= MM0082
  V[2]:= MM0083
  V[3]:= MM0084
  I[1]:= MM0085
  I[2]:= MM0086
  I[3]:= MM0087
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      19.
ENDUSE
USE WRITEPROBEV AS M20
INPUT
  V[1]:= MM0088
  V[2]:= MM0089
  V[3]:= MM0090
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      20.
ENDUSE
USE WRITEPROBEI AS M21
INPUT
  V[1]:= MM0091
  V[2]:= MM0092
  V[3]:= MM0093
  I[1]:= MM0094
  I[2]:= MM0095
  I[3]:= MM0096
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      21.
ENDUSE
USE WRITEPROBEV AS M22
INPUT
  V[1]:= MM0097
  V[2]:= MM0098
  V[3]:= MM0099
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      22.
ENDUSE
USE WRITEPROBEI AS M23
INPUT
  V[1]:= MM0100
  V[2]:= MM0101
  V[3]:= MM0102
  I[1]:= MM0103
  I[2]:= MM0104
  I[3]:= MM0105
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      23.
ENDUSE
USE WRITEPROBEV AS M24
INPUT
  V[1]:= MM0106
  V[2]:= MM0107
  V[3]:= MM0108
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      24.
ENDUSE
USE WRITEPROBEI AS M25
INPUT
  V[1]:= MM0109
  V[2]:= MM0110
  V[3]:= MM0111
  I[1]:= MM0112
  I[2]:= MM0113
  I[3]:= MM0114
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      25.
ENDUSE
USE WRITEPROBEV AS M26
INPUT
  V[1]:= MM0115
  V[2]:= MM0116
  V[3]:= MM0117
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      26.
ENDUSE
USE WRITEPROBEI AS M27
INPUT
  V[1]:= MM0118
  V[2]:= MM0119
  V[3]:= MM0120
  I[1]:= MM0121
  I[2]:= MM0122
  I[3]:= MM0123
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      27.
ENDUSE
USE WRITEPROBEV AS M28
INPUT
  V[1]:= MM0124
  V[2]:= MM0125
  V[3]:= MM0126
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      28.
ENDUSE
USE WRITEPROBEI AS M29
INPUT
  V[1]:= MM0127
  V[2]:= MM0128
  V[3]:= MM0129
  I[1]:= MM0130
  I[2]:= MM0131
  I[3]:= MM0132
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      29.
ENDUSE
USE WRITEPROBEV AS M30
INPUT
  V[1]:= MM0133
  V[2]:= MM0134
  V[3]:= MM0135
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      30.
ENDUSE
USE WRITEPROBEI AS M31
INPUT
  V[1]:= MM0136
  V[2]:= MM0137
  V[3]:= MM0138
  I[1]:= MM0139
  I[2]:= MM0140
  I[3]:= MM0141
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      31.
ENDUSE
USE WRITEPROBEV AS M32
INPUT
  V[1]:= MM0142
  V[2]:= MM0143
  V[3]:= MM0144
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      32.
ENDUSE
USE WRITEPROBEI AS M33
INPUT
  V[1]:= MM0145
  V[2]:= MM0146
  V[3]:= MM0147
  I[1]:= MM0148
  I[2]:= MM0149
  I[3]:= MM0150
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      33.
ENDUSE
USE WRITEPROBEV AS M34
INPUT
  V[1]:= MM0151
  V[2]:= MM0152
  V[3]:= MM0153
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      34.
ENDUSE
USE WRITEPROBEI AS M35
INPUT
  V[1]:= MM0154
  V[2]:= MM0155
  V[3]:= MM0156
  I[1]:= MM0157
  I[2]:= MM0158
  I[3]:= MM0159
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      35.
ENDUSE
USE WRITEPROBEV AS M36
INPUT
  V[1]:= MM0160
  V[2]:= MM0161
  V[3]:= MM0162
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      36.
ENDUSE
USE WRITEPROBEI AS M37
INPUT
  V[1]:= MM0163
  V[2]:= MM0164
  V[3]:= MM0165
  I[1]:= MM0166
  I[2]:= MM0167
  I[3]:= MM0168
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      37.
ENDUSE
USE WRITEPROBEV AS M38
INPUT
  V[1]:= MM0169
  V[2]:= MM0170
  V[3]:= MM0171
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      38.
ENDUSE
USE WRITEPROBEI AS M39
INPUT
  V[1]:= MM0172
  V[2]:= MM0173
  V[3]:= MM0174
  I[1]:= MM0175
  I[2]:= MM0176
  I[3]:= MM0177
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      39.
ENDUSE
USE WRITEPROBEV AS M40
INPUT
  V[1]:= MM0178
  V[2]:= MM0179
  V[3]:= MM0180
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      40.
ENDUSE
USE WRITEPROBEI AS M41
INPUT
  V[1]:= MM0181
  V[2]:= MM0182
  V[3]:= MM0183
  I[1]:= MM0184
  I[2]:= MM0185
  I[3]:= MM0186
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      41.
ENDUSE
USE WRITEPROBEV AS M42
INPUT
  V[1]:= MM0187
  V[2]:= MM0188
  V[3]:= MM0189
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      42.
ENDUSE
USE WRITEPROBEI AS M43
INPUT
  V[1]:= MM0190
  V[2]:= MM0191
  V[3]:= MM0192
  I[1]:= MM0193
  I[2]:= MM0194
  I[3]:= MM0195
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      43.
ENDUSE
USE WRITEPROBEV AS M44
INPUT
  V[1]:= MM0196
  V[2]:= MM0197
  V[3]:= MM0198
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      44.
ENDUSE
USE WRITEPROBEI AS M45
INPUT
  V[1]:= MM0199
  V[2]:= MM0200
  V[3]:= MM0201
  I[1]:= MM0202
  I[2]:= MM0203
  I[3]:= MM0204
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      45.
ENDUSE
USE WRITEPROBEV AS M46
INPUT
  V[1]:= MM0205
  V[2]:= MM0206
  V[3]:= MM0207
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      46.
ENDUSE
USE ABC2RMS AS ABC2RMS
INPUT
  x[1]:= MM0208
  x[2]:= MM0209
  x[3]:= MM0210
DATA
  freq:=      60.
  xrms_ini:=       1.
  scale:= 0.004028
  SampleFreq:=   15360.
OUTPUT
  X0033A:=xrms[1]
  X0033B:=xrms[2]
  X0033C:=xrms[3]
ENDUSE
USE PF AS M48
INPUT
  Qref:= MM0211
  VIN[1]:= X0033A
  VIN[2]:= X0033B
  VIN[3]:= X0033C
  Pref:= MM0215
  Pava:= MM0216
DATA
  ILIM0:=      1.2
OUTPUT
  XX0026:=IQMIN
  XX0027:=PMAX
ENDUSE
USE PLLDQ AS PLLDQ
INPUT
  u[1]:= MM0208
  u[2]:= MM0209
  u[3]:= MM0210
DATA
  theta0:=        0.0
  f0:=        60.
  Gain:=      22.85
OUTPUT
  XX0135:=FREQ
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_I AS DQ
INPUT
  In[1]:= MM0217
  In[2]:= MM0218
  In[3]:= MM0219
  f:= XX0135
DATA
  Vnom:=     400.
  Pnom:=     2.E5
OUTPUT
  X0138A:=DQ[1]
  X0138B:=DQ[2]
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_V AS DQ
INPUT
  VIn[1]:= MM0208
  VIn[2]:= MM0209
  VIn[3]:= MM0210
  f:= XX0135
DATA
  Vnom:=     400.
OUTPUT
  X0136A:=DQ[1]
  X0136B:=DQ[2]
ENDUSE
C Outer loop
USE OUTER3 AS M52
INPUT
  Vdq[1]:= X0136A
  Vdq[2]:= X0136B
  Pref:= MM0223
  Qref:= MM0224
DATA
  ILIM:=      1.2
OUTPUT
  X0137A:=Idq[1]
  X0137B:=Idq[2]
ENDUSE
USE INNER AS M53
INPUT
  Vdq_m[1]:= X0136A
  Vdq_m[2]:= X0136B
  Idq_m[1]:= X0138A
  Idq_m[2]:= X0138B
  Idq_r[1]:= X0137A
  Idq_r[2]:= X0137B
DATA
  Rf:=     0.28
  Lf:=    5.E-4
  Pnom:=     2.E5
  Vnom:=     400.
  Kp:=     8.78
  Ki:=    22.18
OUTPUT
  X0139A:=Vdq_r[1]
  X0139B:=Vdq_r[2]
  X0134A:=Vdq_pu[1]
  X0134B:=Vdq_pu[2]
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_INV AS DQ_Inv
INPUT
  DQ[1]:= X0139A
  DQ[2]:= X0139B
  f:= XX0135
OUTPUT
  X0029A:=abc[1]
  X0029B:=abc[2]
  X0029C:=abc[3]
ENDUSE
USE UI2PQ3 AS UI2PQ3
INPUT
  V[1]:= MM0231
  V[2]:= MM0232
  V[3]:= MM0233
  I[1]:= MM0234
  I[2]:= MM0235
  I[3]:= MM0236
DATA
  FREQ:=      60.
  SampleFreq:=     600.
  ScaleV:=       1.
  ScaleI:=       1.
  Algorithm:=      0.0
OUTPUT
  PDER3:=P
  QDER3:=Q
ENDUSE
USE ABC2RMS AS ABC2RMS
INPUT
  x[1]:= MM0231
  x[2]:= MM0232
  x[3]:= MM0233
DATA
  freq:=      60.
  xrms_ini:=       1.
  scale:= 0.004028
  SampleFreq:=   15360.
OUTPUT
  X0043A:=xrms[1]
  X0043B:=xrms[2]
  X0043C:=xrms[3]
ENDUSE
USE PF AS M57
INPUT
  Qref:= MM0237
  VIN[1]:= X0043A
  VIN[2]:= X0043B
  VIN[3]:= X0043C
  Pref:= MM0241
  Pava:= MM0242
DATA
  ILIM0:=      1.2
OUTPUT
  XX0035:=IQMIN
  XX0036:=PMAX
ENDUSE
USE PLLDQ AS PLLDQ
INPUT
  u[1]:= MM0231
  u[2]:= MM0232
  u[3]:= MM0233
DATA
  theta0:=        0.0
  f0:=        60.
  Gain:=      22.85
OUTPUT
  XX0146:=FREQ
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_I AS DQ
INPUT
  In[1]:= MM0243
  In[2]:= MM0244
  In[3]:= MM0245
  f:= XX0146
DATA
  Vnom:=     400.
  Pnom:=     1.E5
OUTPUT
  X0149A:=DQ[1]
  X0149B:=DQ[2]
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_V AS DQ
INPUT
  VIn[1]:= MM0231
  VIn[2]:= MM0232
  VIn[3]:= MM0233
  f:= XX0146
DATA
  Vnom:=     400.
OUTPUT
  X0147A:=DQ[1]
  X0147B:=DQ[2]
ENDUSE
C Outer loop
USE OUTER3 AS M61
INPUT
  Vdq[1]:= X0147A
  Vdq[2]:= X0147B
  Pref:= MM0249
  Qref:= MM0250
DATA
  ILIM:=      1.2
OUTPUT
  X0148A:=Idq[1]
  X0148B:=Idq[2]
ENDUSE
USE INNER AS M62
INPUT
  Vdq_m[1]:= X0147A
  Vdq_m[2]:= X0147B
  Idq_m[1]:= X0149A
  Idq_m[2]:= X0149B
  Idq_r[1]:= X0148A
  Idq_r[2]:= X0148B
DATA
  Rf:=     0.28
  Lf:=    5.E-4
  Pnom:=     1.E5
  Vnom:=     400.
  Kp:=     0.15
  Ki:=       6.
OUTPUT
  X0150A:=Vdq_r[1]
  X0150B:=Vdq_r[2]
  X0145A:=Vdq_pu[1]
  X0145B:=Vdq_pu[2]
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_INV AS DQ_Inv
INPUT
  DQ[1]:= X0150A
  DQ[2]:= X0150B
  f:= XX0146
OUTPUT
  X0038A:=abc[1]
  X0038B:=abc[2]
  X0038C:=abc[3]
ENDUSE
USE UI2PQ3 AS UI2PQ3
INPUT
  V[1]:= MM0257
  V[2]:= MM0258
  V[3]:= MM0259
  I[1]:= MM0260
  I[2]:= MM0261
  I[3]:= MM0262
DATA
  FREQ:=      60.
  SampleFreq:=     600.
  ScaleV:=       1.
  ScaleI:=       1.
  Algorithm:=      0.0
OUTPUT
  PDER2:=P
  QDER2:=Q
ENDUSE
USE ABC2RMS AS ABC2RMS
INPUT
  x[1]:= MM0257
  x[2]:= MM0258
  x[3]:= MM0259
DATA
  freq:=      60.
  xrms_ini:=       1.
  scale:= 0.004028
  SampleFreq:=   15360.
OUTPUT
  X0053A:=xrms[1]
  X0053B:=xrms[2]
  X0053C:=xrms[3]
ENDUSE
USE PF AS M66
INPUT
  Qref:= MM0263
  VIN[1]:= X0053A
  VIN[2]:= X0053B
  VIN[3]:= X0053C
  Pref:= MM0267
  Pava:= MM0268
DATA
  ILIM0:=      1.2
OUTPUT
  XX0046:=IQMIN
  XX0047:=PMAX
ENDUSE
USE PLLDQ AS PLLDQ
INPUT
  u[1]:= MM0257
  u[2]:= MM0258
  u[3]:= MM0259
DATA
  theta0:=        0.0
  f0:=        60.
  Gain:=      22.85
OUTPUT
  XX0157:=FREQ
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_I AS DQ
INPUT
  In[1]:= MM0269
  In[2]:= MM0270
  In[3]:= MM0271
  f:= XX0157
DATA
  Vnom:=     400.
  Pnom:=     1.E5
OUTPUT
  X0160A:=DQ[1]
  X0160B:=DQ[2]
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_V AS DQ
INPUT
  VIn[1]:= MM0257
  VIn[2]:= MM0258
  VIn[3]:= MM0259
  f:= XX0157
DATA
  Vnom:=     400.
OUTPUT
  X0158A:=DQ[1]
  X0158B:=DQ[2]
ENDUSE
C Outer loop
USE OUTER3 AS M70
INPUT
  Vdq[1]:= X0158A
  Vdq[2]:= X0158B
  Pref:= MM0275
  Qref:= MM0276
DATA
  ILIM:=      1.2
OUTPUT
  X0159A:=Idq[1]
  X0159B:=Idq[2]
ENDUSE
USE INNER AS M71
INPUT
  Vdq_m[1]:= X0158A
  Vdq_m[2]:= X0158B
  Idq_m[1]:= X0160A
  Idq_m[2]:= X0160B
  Idq_r[1]:= X0159A
  Idq_r[2]:= X0159B
DATA
  Rf:=     0.28
  Lf:=    5.E-4
  Pnom:=     1.E5
  Vnom:=     400.
  Kp:=     0.15
  Ki:=       6.
OUTPUT
  X0161A:=Vdq_r[1]
  X0161B:=Vdq_r[2]
  X0156A:=Vdq_pu[1]
  X0156B:=Vdq_pu[2]
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_INV AS DQ_Inv
INPUT
  DQ[1]:= X0161A
  DQ[2]:= X0161B
  f:= XX0157
OUTPUT
  X0049A:=abc[1]
  X0049B:=abc[2]
  X0049C:=abc[3]
ENDUSE
USE UI2PQ3 AS UI2PQ3
INPUT
  V[1]:= MM0283
  V[2]:= MM0284
  V[3]:= MM0285
  I[1]:= MM0286
  I[2]:= MM0287
  I[3]:= MM0288
DATA
  FREQ:=      60.
  SampleFreq:=     600.
  ScaleV:=       1.
  ScaleI:=       1.
  Algorithm:=      0.0
OUTPUT
  PDER4:=P
  QDER4:=Q
ENDUSE
USE ABC2RMS AS ABC2RMS
INPUT
  x[1]:= MM0283
  x[2]:= MM0284
  x[3]:= MM0285
DATA
  freq:=      60.
  xrms_ini:=       1.
  scale:= 0.004028
  SampleFreq:=   15360.
OUTPUT
  X0065A:=xrms[1]
  X0065B:=xrms[2]
  X0065C:=xrms[3]
ENDUSE
USE PF AS M75
INPUT
  Qref:= MM0289
  VIN[1]:= X0065A
  VIN[2]:= X0065B
  VIN[3]:= X0065C
  Pref:= MM0293
  Pava:= MM0294
DATA
  ILIM0:=      1.2
OUTPUT
  XX0057:=IQMIN
  XX0058:=PMAX
ENDUSE
USE PLLDQ AS PLLDQ
INPUT
  u[1]:= MM0283
  u[2]:= MM0284
  u[3]:= MM0285
DATA
  theta0:=        0.0
  f0:=        60.
  Gain:=      22.85
OUTPUT
  XX0168:=FREQ
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_I AS DQ
INPUT
  In[1]:= MM0295
  In[2]:= MM0296
  In[3]:= MM0297
  f:= XX0168
DATA
  Vnom:=     400.
  Pnom:=     5.E3
OUTPUT
  X0171A:=DQ[1]
  X0171B:=DQ[2]
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_V AS DQ
INPUT
  VIn[1]:= MM0283
  VIn[2]:= MM0284
  VIn[3]:= MM0285
  f:= XX0168
DATA
  Vnom:=     400.
OUTPUT
  X0169A:=DQ[1]
  X0169B:=DQ[2]
ENDUSE
C Outer loop
USE OUTER3 AS M79
INPUT
  Vdq[1]:= X0169A
  Vdq[2]:= X0169B
  Pref:= MM0301
  Qref:= MM0302
DATA
  ILIM:=      1.2
OUTPUT
  X0170A:=Idq[1]
  X0170B:=Idq[2]
ENDUSE
USE INNER AS M80
INPUT
  Vdq_m[1]:= X0169A
  Vdq_m[2]:= X0169B
  Idq_m[1]:= X0171A
  Idq_m[2]:= X0171B
  Idq_r[1]:= X0170A
  Idq_r[2]:= X0170B
DATA
  Rf:=     0.28
  Lf:=    5.E-4
  Pnom:=     5.E3
  Vnom:=     400.
  Kp:=     0.15
  Ki:=       6.
OUTPUT
  X0172A:=Vdq_r[1]
  X0172B:=Vdq_r[2]
  X0167A:=Vdq_pu[1]
  X0167B:=Vdq_pu[2]
ENDUSE
C In 1 (up). Three phase; In 2, theta.  Out 1 y 2 son D y Q. Zero no es consider
USE DQ_INV AS DQ_Inv
INPUT
  DQ[1]:= X0172A
  DQ[2]:= X0172B
  f:= XX0168
OUTPUT
  X0060A:=abc[1]
  X0060B:=abc[2]
  X0060C:=abc[3]
ENDUSE
USE UI2PQ3 AS UI2PQ3
INPUT
  V[1]:= MM0007
  V[2]:= MM0008
  V[3]:= MM0009
  I[1]:= MM0309
  I[2]:= MM0310
  I[3]:= MM0311
DATA
  FREQ:=      60.
  SampleFreq:=     600.
  ScaleV:=       1.
  ScaleI:=       1.
  Algorithm:=      0.0
OUTPUT
  PSUB:=P
  QSUB:=Q
ENDUSE
USE UI2PQ3 AS UI2PQ3
INPUT
  V[1]:= MM0312
  V[2]:= MM0313
  V[3]:= MM0314
  I[1]:= MM0315
  I[2]:= MM0316
  I[3]:= MM0317
DATA
  FREQ:=      60.
  SampleFreq:=     600.
  ScaleV:=       1.
  ScaleI:=       1.
  Algorithm:=      0.0
OUTPUT
  PSYNC:=P
  QSYN:=Q
ENDUSE
USE WRITEPROBEI AS M84
INPUT
  V[1]:= MM0318
  V[2]:= MM0319
  V[3]:= MM0320
  I[1]:= MM0321
  I[2]:= MM0322
  I[3]:= MM0323
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      84.
ENDUSE
USE WRITEPROBEV AS M85
INPUT
  V[1]:= MM0324
  V[2]:= MM0325
  V[3]:= MM0326
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      85.
ENDUSE
USE WRITEPROBEI AS M86
INPUT
  V[1]:= MM0327
  V[2]:= MM0328
  V[3]:= MM0329
  I[1]:= MM0330
  I[2]:= MM0331
  I[3]:= MM0332
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      86.
ENDUSE
USE WRITEPROBEV AS M87
INPUT
  V[1]:= MM0333
  V[2]:= MM0334
  V[3]:= MM0335
DATA
  N:=       3.
  FREQ:=      60.
  TIME:=      0.4
  SampleFreq:=     480.
  IDX:=      87.
ENDUSE
USE UI2PQ3 AS UI2PQ3
INPUT
  V[1]:= MM0336
  V[2]:= MM0337
  V[3]:= MM0338
  I[1]:= MM0339
  I[2]:= MM0340
  I[3]:= MM0341
DATA
  FREQ:=      60.
  SampleFreq:=    1024.
  ScaleV:=       1.
  ScaleI:=       1.
  Algorithm:=      0.0
OUTPUT
  XX0014:=P
  XX0076:=Q
ENDUSE
RECORD
  M48.IQMIN AS IQMIN
  M48.IDMAX AS IDMAX
  M57.IQMIN AS IQMIN
  M57.IDMAX AS IDMAX
  M66.IQMIN AS IQMIN
  M66.IDMAX AS IDMAX
  M75.IQMIN AS IQMIN
  M75.IDMAX AS IDMAX
  XX0027 AS XX0027
  XX0026 AS XX0026
  PDER3  AS PDER3 
  QDER3  AS QDER3 
  XX0036 AS XX0036
  XX0035 AS XX0035
  PDER2  AS PDER2 
  QDER2  AS QDER2 
  XX0047 AS XX0047
  XX0046 AS XX0046
  PDER4  AS PDER4 
  QDER4  AS QDER4 
  XX0058 AS XX0058
  XX0057 AS XX0057
  PSUB   AS PSUB  
  QSUB   AS QSUB  
  PSYNC  AS PSYNC 
  QSYN   AS QSYN  
  XX0014 AS XX0014
  XX0076 AS XX0076
ENDMODELS
C        1         2         3         4         5         6         7         8
C 345678901234567890123456789012345678901234567890123456789012345678901234567890
/BRANCH
C < n1 >< n2 ><ref1><ref2>< R  >< L  >< C  >
C < n1 >< n2 ><ref1><ref2>< R  >< A  >< B  ><Leng><><>0
$VINTAGE,1
C Configuracion_300 Long_786.384
1 N100A N802A                  .6532098696     .6519909744      2.60686296
2 N100B N802B                  .1026624312    .28238263056   -.74825223984
                              .64685588688    .66303180576    2.4910285968
3 N100C N802C                  .1040779224    .24505298208   -.48585162672
                              .10095597792    .22433176368     -.303544224
                               .6495925032     .6582427272    2.3884841232
C Carga CY860
  X0075A                      6300.9146341    5040.7317073                     0
  X0075B                      6300.9146341    5040.7317073                     0
  X0075C                      6300.9146341    5040.7317073                     0
C Configuracion_300 Long_527.304
1 N802A N806A                  .4380050676     .4371877464      1.74801276
2 N802B N806B                  .0688395372    .18934959336   -.50173502904
                              .43374445128    .44459109456    1.6703408808
3 N802C N806C                  .0697886844    .16431847248   -.32578423032
                              .06769528752    .15042401208     -.203539344
                               .4355794692     .4413798132    1.6015804392
C Configuracion_300 Long_9823.704
1 N806A N108A                 8.1600597276    8.1448329864     32.56557876
2 N806B N108B                 1.2824845572    3.5275938694    -9.347352593
                              8.0806841993    8.2827577906    31.118547161
3 N806C N108C                 1.3001672244    3.0612626405   -6.0693790423
                              1.2611671195    2.8024080401    -3.791949744
                              8.1148706892    8.2229314332    29.837536159
C Configuracion_303 Long_1769.0592
1 X0001BXX0019                3.0772784784    1.6329300946    4.6444880237
C Configuracion_300 Long_11430
1 N208A N112A                    9.4943295        9.476613        37.89045
2 N208B N112B                    1.4921865       4.1043987     -10.8757593
                                 9.4019751       9.6370902       36.206811
3 N208C N112C                    1.5127605       3.5618166      -7.0617969
                                 1.4673834       3.2606361        -4.41198
                                 9.4417515       9.5674815       34.716339
C Configuracion_300 Long_9061.704
1 N312A N814A                 7.5271044276    7.5130587864     30.03954876
2 N312B N814B                 1.1830054572    3.2539672894    -8.622301973
                              7.4538858593    7.6402851106    28.704759761
3 N312C N814C                 1.1993165244    2.8238082005   -5.5985925823
                              1.1633415595    2.5850323001    -3.497817744
                              7.4854205892    7.5850993332    27.523113559
C Configuracion_301 Long_3.048
1 X0007AN850A                  .0036551616    .00267330936     .0096984312
2 X0007BN850B                 .00044071032    .00122008392   -.00272046192
                               .0036283392    .00270473424     .0092906088
3 X0007CN850C                 .00044677584    .00107783376   -.00178067208
                              .00043333416    .00099206304   -.00112708944
                               .0036399216    .00269110968       .00893064
C Configuracion_301 Long_94.488
1 N850A N116A                  .1133100096    .08287259016     .3006513672
2 N850B N116B                 .01366201992    .03782260152   -.08433431952
                               .1124785152    .08384676144     .2880088728
3 N850C N116C                 .01385005104    .03341284656   -.05520083448
                              .01343335896    .03075395424   -.03493977264
                               .1128375696    .08342440008       .27684984
C Configuracion_302 Long_521.208
1 X0002AXX0015                  .906641316     .4811010444    1.3683794832
C Configuracion_301 Long_3112.008
1 N216A N124A                 3.7319199936    2.7294488566    9.9020982552
2 N216B N124B                 .44996523672    1.2457056823   -2.7775916203
                              3.7045343232     2.761533659    9.4857115848
3 N216C N124C                 .45615813264     1.100468269   -1.8180661937
                              .44243417736    1.0128963638   -1.1507583182
                              3.7163599536    2.7476229833      9.11818344
C Configuracion_302 Long_14676.12
1 XX0015XX0016                 25.52911074    13.546792566    38.530685448
C Configuracion_302 Long_4187.952
1 XX0016XX0020                 7.284942504    3.8656890936    10.995049181
C Configuracion_303 Long_923.544
1 X0003BXX0021                 1.606504788     .8524772892    2.4246724176
C Configuracion_301 Long_256.032
1 N324A N828A                  .3070335744    .22455798624     .8146682208
2 N324B N828B                 .03701966688    .10248704928   -.22851880128
                               .3047804928    .22719767616     .7804111392
3 N324C N828C                 .03752917056    .09053803584   -.14957645472
                              .03640006944    .08333329536   -.09467551296
                               .3057534144    .22605321312       .75017376
C Configuracion_301 Long_6230.112
1 N828A N830A                 7.4711503104    5.4642443318    19.823593373
2 N828B N830B                 .90081189408    2.4938515325   -5.5606241645
                              7.4163253248    5.5284767866    18.990004387
3 N828C N830C                 .91320981696    2.2030922054   -3.6396937315
                              .88573502304    2.0277768538   -2.3037708154
                              7.4399997504    5.5006281859     18.25422816
C Configuracion_301 Long_158.496
1 N830A N154A                  .1900684032    .13901208672     .5043184224
2 N830B N154B                 .02291693664    .06344436384   -.14146401984
                               .1886736384    .14064618048     .4831116576
3 N830C N154C                 .02323234368    .05604735552   -.09259494816
                              .02253337632    .05158727808   -.05860865088
                               .1892759232    .13993770336       .46439328
C Configuracion_301 Long_11225.784
1 N254A N852A                 13.461960173    9.8457983729     35.71932211
2 N254B N852B                 1.6231361086    4.4935690774   -10.019461251
                              13.363173274    9.9615362059     34.21731221
3 N254C N852C                 1.6454754187    3.9696617381   -6.5582152706
                              1.5959697113    3.6537681763   -4.1510704075
                              13.405831253    9.9113569514     32.89154712
C Configuracion_303 Long_7110.984
1 X0004BXX0022                12.369556668    6.5637937812    18.669177394
C Configuracion_301 Long_3.048
1 X0008AN832A                  .0036551616    .00267330936     .0096984312
2 X0008BN832B                 .00044071032    .00122008392   -.00272046192
                               .0036283392    .00270473424     .0092906088
3 X0008CN832C                 .00044677584    .00107783376   -.00178067208
                              .00043333416    .00099206304   -.00112708944
                               .0036399216    .00269110968       .00893064
C Configuracion_301 Long_1493.52
1 N832A N358A                  1.791029184    1.3099215864     4.752231288
2 N832B N358B                  .2159480568     .5978411208   -1.3330263408
                               1.777886208    1.3253197776     4.552398312
3 N832C N358C                  .2189201616     .5281385424    -.8725293192
                               .2123337384     .4861108896    -.5522738256
                               1.783561584    1.3186437432       4.3760136
C Configuracion_302 Long_493.776
1 X0005AXX0009                  .858923352     .4557799368    1.2963595104
C Configuracion_301 Long_1776.984
1 N258A N134A                 2.1309592128    1.5585393569    5.6541853896
2 N258B N134B                 .25693411656    .71130892536   -1.5860292994
                              2.1153217536    1.5768600619    5.4164249304
3 N258C N134C                 .26047031472    .62837708208   -1.0381318226
                              .25263381528    .57837275232   -.65709314352
                              2.1220742928    1.5689169434      5.20656312
C Configuracion_301 Long_615.696
1 N334A N860A                  .7383426432    .54000849072    1.9590831024
2 N334B N860B                 .08902348464    .24645695184   -.54953330784
                               .7329245184    .54635631648    1.8767029776
3 N334C N860C                 .09024871968    .21772241952   -.35969576016
                              .08753350032    .20039673408   -.22767206688
                               .7352641632    .54360415536      1.80398928
C Configuracion_301 Long_816.864
1 N860A N136A                  .9795833088    .71644690848    2.5991795616
2 N860B N136B                 .11811036576    .32698249056   -.72908379456
                               .9723949056    .72486877632    2.4898831584
3 N860C N136C                 .11973592512    .28885944768   -.47722011744
                              .11613355488    .26587289472   -.30205996992
                               .9754989888    .72121739424      2.39341152
C Configuracion_301 Long_262.128
1 N236A N840A                  .3143438976    .22990460496     .8340650832
2 N236B N840B                 .03790108752    .10492721712   -.23395972512
                               .3120371712    .23260714464     .7989923568
3 N236C N840C                 .03842272224    .09269370336   -.15313779888
                              .03726673776    .08531742144   -.09692969184
                               .3130332576    .23143543248       .76803504
C Configuracion_301 Long_85.344
1 N336A N862A                  .1023445248    .07485266208     .2715560736
2 N336B N862B                 .01233988896    .03416234976   -.07617293376
                               .1015934976    .07573255872     .2601370464
3 N336C N862C                 .01250972352    .03017934528   -.04985881824
                              .01213335648    .02777776512   -.03155850432
                               .1019178048    .07535107104       .25005792
C Configuracion_302 Long_1481.328
1 N862B XX0023                1.7688537648    1.3081459435     4.016620872
C Configuracion_301 Long_85.344
1 N234A N842A                  .1023445248    .07485266208     .2715560736
2 N234B N842B                 .01233988896    .03416234976   -.07617293376
                               .1015934976    .07573255872     .2601370464
3 N234C N842C                 .01250972352    .03017934528   -.04985881824
                              .01213335648    .02777776512   -.03155850432
                               .1019178048    .07535107104       .25005792
C Configuracion_301 Long_411.48
1 N842A N844A                   .493446816     .3608967636     1.309288212
2 N842B N844B                  .0594958932     .1647113292    -.3672623592
                                .489825792     .3651391224     1.254232188
3 N842C N844C                  .0603147384     .1455075576    -.2403907308
                               .0585001116     .1339285104    -.1521570744
                                .491389416     .3632998068       1.2056364
C Configuracion_301 Long_1109.472
1 N844A N846A                 1.3304788224    .97308460704    3.5302289568
2 N844B N846B                 .16041855648    .44411054688   -.99024813888
                              1.3207154688    .98452326336    3.3817816032
3 N844C N846C                 .16262640576    .39233148864   -.64816463712
                              .15773363424    .36111094656   -.41026055616
                              1.3249314624    .97956392352      3.25075296
C Configuracion_301 Long_161.544
1 N846A N848A                  .1937235648    .14168539608     .5140168536
2 N846B N848B                 .02335764696    .06466444776   -.14418448176
                               .1923019776    .14335091472     .4924022664
3 N846C N848C                 .02367911952    .05712518928   -.09437562024
                              .02296671048    .05257934112   -.05973574032
                               .1929158448    .14262881304       .47332392
C Carga CY840
  N840A                       14307.923077    11128.384615                     0
  N840B                       14307.923077    11128.384615                     0
  N840C                       14307.923077    11128.384615                     0
C Carga CY844
  N844A                       953.86153846    741.89230769                     0
  N844B                       953.86153846    741.89230769                     0
  N844C                       953.86153846    741.89230769                     0
C Carga CD830
  N830A N830B                      49600.8         24800.4                     0
  N830B N830C                      49600.8         24800.4                     0
  N830C N830A                 21379.655172     8551.862069                     0
C Carga CD848
  N848A N848B                 18902.743902    15122.195122                     0
  N848B N848C                 18902.743902    15122.195122                     0
  N848C N848A                 18902.743902    15122.195122                     0
C Carga CY802
  N802A                              1.E30           1.E30                     0
  N802B                            11022.4          5511.2                     0
  N802C                       12586.479903    7048.4287454                     0
C Carga CY806
  N806A                              1.E30           1.E30                     0
  N806B                            11022.4          5511.2                     0
  N806C                       12586.479903    7048.4287454                     0
C Carga C808
  X0001B                            20667.         10333.5                     0
C Carga C810
  XX0019                            20667.         10333.5                     0
C Carga C818
  XX0015                      9725.6470588    4862.8235294                     0
C Carga C820
  XX0016                      9725.6470588    4862.8235294                     0
C Carga C820a
  XX0016                      2413.0118919    1251.1913514                     0
C Carga C822
  XX0020                      2413.0118919    1251.1913514                     0
C Carga CD836a
  X0018AX0018B                      55112.          27556.                     0
  X0018BX0018C                45091.636364    22545.818182                     0
  X0018CX0018A                       1.E30           1.E30                     0
C Carga CD840
  N840A N840B                       55112.          27556.                     0
  N840B N840C                 45091.636364    22545.818182                     0
  N840C N840A                        1.E30           1.E30                     0
C Carga C824a
  X0003B                            8266.8          4133.4                     0
C Carga C826
  XX0021                            8266.8          4133.4                     0
C Carga C824b
  X0003A                            82668.          41334.                     0
C Carga C828
  N828C                             82668.          41334.                     0
C Carga C854
  X0004B                            82668.          41334.                     0
C Carga C856
  XX0022                            82668.          41334.                     0
C Carga CD832
  N832A N832B                 149657.58621    64138.965517                     0
  N832B N832C                      496008.         248004.                     0
  N832C N832A                      165336.          82668.                     0
C Carga CD858
  N358A N358B                 149657.58621    64138.965517                     0
  N358B N358C                      496008.         248004.                     0
  N358C N358A                      165336.          82668.                     0
C Carga C864
  XX0009                           165336.          82668.                     0
C Carga C858
  X0005A                           165336.          82668.                     0
C Carga CD834a
  N334A N334B                       62001.         31000.5                     0
  N334B N334C                      49600.8         24800.4                     0
  N334C N334A                 9018.3272727    4509.1636364                     0
C Carga CD860
  N860A N860B                       62001.         31000.5                     0
  N860B N860C                      49600.8         24800.4                     0
  N860C N860A                 9018.3272727    4509.1636364                     0
C Carga CD858a
  X0005AX0005B                     248004.         124002.                     0
  X0005BX0005C                64360.899654    34325.813149                     0
  X0005CX0005A                73946.146789    39817.155963                     0
C Carga CD834
  X0017AX0017B                     248004.         124002.                     0
  X0017BX0017C                64360.899654    34325.813149                     0
  X0017CX0017A                73946.146789    39817.155963                     0
C Carga C842
  N842A                        35094.90566    19497.169811                     0
C Carga C844
  N844A                        35094.90566    19497.169811                     0
C Carga CD860a
  X0075AX0075B                     33067.2         16533.6                     0
  X0075BX0075C                91177.941176    54706.764706                     0
  X0075CX0075A                23167.633452    12135.427046                     0
C Carga C862
  N862B                       11809.714286    5904.8571429                     0
C Carga C838
  XX0023                      11809.714286    5904.8571429                     0
C Carga CY844a
  N844A                              1.E30           1.E30                     0
  N844B                       13437.581274    6450.0390117                     0
  N844C                       15867.178503    8726.9481766                     0
C Carga CY846a
  N846A                              1.E30           1.E30                     0
  N846B                       13437.581274    6450.0390117                     0
  N846C                       15867.178503    8726.9481766                     0
C Carga C846
  N846B                       14625.876923    6994.9846154                     0
C Carga C848
  N848B                       14625.876923    6994.9846154                     0
C Carga CD836
  X0018AX0018B                     33067.2         16533.6                     0
  X0018BX0018C                91177.941176    54706.764706                     0
  X0018CX0018A                23167.633452    12135.427046                     0
C Carga CD816
  X0002AX0002B                       1.E30           1.E30                     0
  X0002BX0002C                213796.55172     85518.62069                     0
  X0002CX0002A                       1.E30           1.E30                     0
C Carga CD824
  N124A N124B                        1.E30           1.E30                     0
  N124B N124C                 213796.55172     85518.62069                     0
  N124C N124A                        1.E30           1.E30                     0
C Carga CY832
  N832A                         38480.5719       17400.524                     0
  N832B                           38743.03       17713.412                     0
  N832C                         39927.5821       19130.092                     0
C Carga C828a
  N828A                       49885.862069    21379.655172                     0
C Carga C830
  N830A                       49885.862069    21379.655172                     0
C Configuracion_301 Long_50
1 X0024AN212A                       .05996        .0438535         .159095
2 X0024BN212B                     .0072295        .0200145        -.044627
                                    .05952         .044369         .152405
3 X0024CN212C                      .007329         .017681       -.0292105
                                  .0071085         .016274        -.018489
                                    .05971        .0441455           .1465
C Configuracion_301 Long_50
1 N840A N866A                      1.25916        .9209235        3.340995
2 N840B N866B                     .1518195        .4203045        -.937167
                                   1.24992         .931749        3.200505
3 N840C N866C                      .153909         .371301       -.6134205
                                  .1492785         .341754        -.388269
                                   1.25391        .9270555          3.0765
C Configuracion_301 Long_50
1 N848A N867A                       .05996        .0438535         .159095
2 N848B N867B                     .0072295        .0200145        -.044627
                                    .05952         .044369         .152405
3 N848C N867C                      .007329         .017681       -.0292105
                                  .0071085         .016274        -.018489
                                    .05971        .0441455           .1465
C Configuracion_301 Long_50
1 X0004AN354A                       .05996        .0438535         .159095
2 X0004BN354B                     .0072295        .0200145        -.044627
                                    .05952         .044369         .152405
3 X0004CN354C                      .007329         .017681       -.0292105
                                  .0071085         .016274        -.018489
                                    .05971        .0441455           .1465
C Configuracion_301 Long_6380
1 N224A N158A                     7.650896       5.5957066       20.300522
2 N224B N158B                     .9224842       2.5538502      -5.6944052
                                  7.594752       5.6614844       19.446878
3 N224C N158C                     .9351804       2.2560956      -3.7272598
                                  .9070446       2.0765624      -2.3591964
                                  7.618996       5.6329658         18.6934
$VINTAGE,0
  X0132AX0130A                   .0754                                         0
  X0132BX0130B                   .0754                                         0
  X0132CX0130C                   .0754                                         0
        X0132A                        18850.                                   0
        X0132B                        18850.                                   0
        X0132C                        18850.                                   0
  X0029AX0131A               .28                                               0
  X0029BX0131B               .28                                               0
  X0029CX0131C               .28                                               0
  X0131AX0028A                   .1885                                         0
  X0131BX0028B                   .1885                                         0
  X0131CX0028C                   .1885                                         0
  X0143AX0141A                   .0754                                         0
  X0143BX0141B                   .0754                                         0
  X0143CX0141C                   .0754                                         0
        X0143A                        18850.                                   0
        X0143B                        18850.                                   0
        X0143C                        18850.                                   0
  X0038AX0142A               .28                                               0
  X0038BX0142B               .28                                               0
  X0038CX0142C               .28                                               0
  X0142AX0037A                   .1885                                         0
  X0142BX0037B                   .1885                                         0
  X0142CX0037C                   .1885                                         0
  X0154AX0152A                   .0754                                         0
  X0154BX0152B                   .0754                                         0
  X0154CX0152C                   .0754                                         0
        X0154A                        18850.                                   0
        X0154B                        18850.                                   0
        X0154C                        18850.                                   0
  X0049AX0153A               .28                                               0
  X0049BX0153B               .28                                               0
  X0049CX0153C               .28                                               0
  X0153AX0048A                   .1885                                         0
  X0153BX0048B                   .1885                                         0
  X0153CX0048C                   .1885                                         0
  X0165AX0163A                   .0754                                         0
  X0165BX0163B                   .0754                                         0
  X0165CX0163C                   .0754                                         0
        X0165A                        18850.                                   0
        X0165B                        18850.                                   0
        X0165C                        18850.                                   0
  X0060AX0164A               .28                                               0
  X0060BX0164B               .28                                               0
  X0060CX0164C               .28                                               0
  X0164AX0059A                   .1885                                         0
  X0164BX0059B                   .1885                                         0
  X0164CX0059C                   .1885                                         0
$VINTAGE,1
C Carga CY844a
  X0071A                             1.E12                                     0
  X0071B                             1.E12                                     0
  X0071C                             1.E12                                     0
$VINTAGE,0
C ----------------------------------------------------------------------
C Nonlinear core representation
C ----------------------------------------------------------------------
98I0078AT0001A            0.449846.895
   0.11245891828    26.306841693
   0.22491783655    37.192432135
    0.4498356731      46.8948067
    0.8996713462    53.929028752
    1.7993426924    58.301653978
    3.5986853848    60.765106132
    28.789483079    63.097978296
           9999.
  I0078AT0001A            5.11E5
98I0078BT0001B            0.449846.895
   0.11245891828    26.306841693
   0.22491783655    37.192432135
    0.4498356731      46.8948067
    0.8996713462    53.929028752
    1.7993426924    58.301653978
    3.5986853848    60.765106132
    28.789483079    63.097978296
           9999.
  I0078BT0001B            5.11E5
98I0078CT0001C            0.449846.895
   0.11245891828    26.306841693
   0.22491783655    37.192432135
    0.4498356731      46.8948067
    0.8996713462    53.929028752
    1.7993426924    58.301653978
    3.5986853848    60.765106132
    28.789483079    63.097978296
           9999.
  I0078CT0001C            5.11E5
98I0078BIX0079            0.449837.192
   0.11245891828    16.593546002
   0.22491783655    26.306841693
    0.4498356731    37.192432135
    0.8996713462      46.8948067
    1.7993426924    53.929028752
    3.5986853848    58.301653978
    28.789483079     62.75379323
           9999.
  I0078BIX0079            2.56E5
98I0078CIX0079            0.449837.192
   0.11245891828    16.593546002
   0.22491783655    26.306841693
    0.4498356731    37.192432135
    0.8996713462      46.8948067
    1.7993426924    53.929028752
    3.5986853848    58.301653978
    28.789483079     62.75379323
           9999.
  I0078CIX0079            2.56E5
  I0078AIX0079             1.E-6
        IX0079             1.E-6
  T0001AI0078B            0.34916.6667
  T0001BI0078C            0.34916.6667
  T0001C                  0.34916.6667
  I0078A                    1.E7
  I0078B                    1.E7
  I0078C                    1.E7
C ----------------------------------------------------------------------
C [R] matrix
C ----------------------------------------------------------------------
$VINTAGE, 1,
  X0070AX0070X                    25.82016
  X0070BX0070Y                    25.82016
  X0070CX0070Z                    25.82016
  X0025AX0025X                     1.24002
  X0025BX0025Y                     1.24002
  X0025CX0025Z                     1.24002
C ----------------------------------------------------------------------
C [A] matrix
C ----------------------------------------------------------------------
  USE AR
01X0070XX0070C               0.91254062337             0.0
02X0025X                     -4.1640633362             0.0
                              57.003785992             0.0
03I0078AT0001A            8.0366743023E-16             0.0
                             -38.002523995             0.0
                              38.002523995             0.0
04X0070YX0070A                         0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                             0.91254062337             0.0
05X0025Y                               0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                             -4.1640633362             0.0
                              57.003785992             0.0
06I0078BT0001B                         0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                          8.0366743023E-16             0.0
                             -38.002523995             0.0
                              38.002523995             0.0
07X0070ZX0070B                         0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                             0.91254062337             0.0
08X0025Z                               0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                             -4.1640633362             0.0
                              57.003785992             0.0
09I0078CT0001C                         0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                          8.0366743023E-16             0.0
                             -38.002523995             0.0
                              38.002523995             0.0
  USE RL
C ----------------------------------------------------------------------
C [C] matrix
C ----------------------------------------------------------------------
$UNITS, 0, 0
C First half at the start of the windings
01X0070A                              1.E8             0.0  .0034178159682
02X0025A                               0.0             0.0 -.0016244750461
                                      1.E8             0.0  .0054149168205
03X0070B                               0.0             0.0                
                                       0.0             0.0                
                                      1.E8             0.0  .0034178159682
04X0025B                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0 -.0016244750461
                                      1.E8             0.0  .0054149168205
05X0070C                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                      1.E8             0.0  .0034178159682
06X0025C                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0 -.0016244750461
                                      1.E8             0.0  .0054149168205
C Second half at the end of the windings
01X0070C                              1.E8             0.0  .0034178159682
02X0025A                               0.0             0.0-.00081223752307
                                      1.E8             0.0  .0054149168205
03X0070A                               0.0             0.0                
                                       0.0             0.0                
                                      1.E8             0.0  .0034178159682
04X0025B                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0 -.0016244750461
                                      1.E8             0.0  .0054149168205
05X0070B                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                      1.E8             0.0  .0034178159682
06X0025C                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0 -.0016244750461
                                      1.E8             0.0  .0054149168205
$UNITS, -1, -1
$VINTAGE, 0,
C ----------------------------------------------------------------------
C Nonlinear core representation
C ----------------------------------------------------------------------
98I0080AT0002A            1.14321.2396
   0.28581025938   0.69536219366
   0.57162051876     0.983100245
    1.1432410375     1.239563628
     2.286482075    1.4255008339
    4.5729641501    1.5410852194
    9.1459283001    1.6062065429
    73.167426401    1.6679351056
           9999.
  I0080AT0002A            5229.3
98I0080BT0002B            1.14321.2396
   0.28581025938   0.69536219366
   0.57162051876     0.983100245
    1.1432410375     1.239563628
     2.286482075    1.4255008339
    4.5729641501    1.5410852194
    9.1459283001    1.6062065429
    73.167426401    1.6679351056
           9999.
  I0080BT0002B            5229.3
98I0080CT0002C            1.14321.2396
   0.28581025938   0.69536219366
   0.57162051876     0.983100245
    1.1432410375     1.239563628
     2.286482075    1.4255008339
    4.5729641501    1.5410852194
    9.1459283001    1.6062065429
    73.167426401    1.6679351056
           9999.
  I0080CT0002C            5229.3
98I0080BIX0081            1.14320.9831
   0.28581025938   0.43861232058
   0.57162051876   0.69536219366
    1.1432410375     0.983100245
     2.286482075     1.239563628
    4.5729641501    1.4255008339
    9.1459283001    1.5410852194
    73.167426401     1.658800997
           9999.
  I0080BIX0081            2614.7
98I0080CIX0081            1.14320.9831
   0.28581025938   0.43861232058
   0.57162051876   0.69536219366
    1.1432410375     0.983100245
     2.286482075     1.239563628
    4.5729641501    1.4255008339
    9.1459283001    1.5410852194
    73.167426401     1.658800997
           9999.
  I0080CIX0081            2614.7
  I0080AIX0081             1.E-6
        IX0081             1.E-6
  T0002AI0080B            0.00366.6667
  T0002BI0080C            0.00366.6667
  T0002C                  0.00366.6667
  I0080A                    1.E7
  I0080B                    1.E7
  I0080C                    1.E7
C ----------------------------------------------------------------------
C [R] matrix
C ----------------------------------------------------------------------
$VINTAGE, 1,
  X0072AX0072X             0.0087675403707
  X0072BX0072Y             0.0087675403707
  X0072CX0072Z             0.0087675403707
  X0068AX0068X                17.972898989
  X0068BX0068Y                17.972898989
  X0068CX0068Z                17.972898989
C ----------------------------------------------------------------------
C [A] matrix
C ----------------------------------------------------------------------
  USE AR
01X0072XX0072C                18797.341085             0.0
02X0068X                      -165.6227701             0.0
                              4.3778907642             0.0
03I0080AT0002A               -12531.560723             0.0
                           1.997832635E-14             0.0
                              12531.560723             0.0
04X0072YX0072A                         0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                              18797.341085             0.0
05X0068Y                               0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                              -165.6227701             0.0
                              4.3778907642             0.0
06I0080BT0002B                         0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                             -12531.560723             0.0
                           1.997832635E-14             0.0
                              12531.560723             0.0
07X0072ZX0072B                         0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                              18797.341085             0.0
08X0068Z                               0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                              -165.6227701             0.0
                              4.3778907642             0.0
09I0080CT0002C                         0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                                       0.0             0.0
                             -12531.560723             0.0
                           1.997832635E-14             0.0
                              12531.560723             0.0
  USE RL
C ----------------------------------------------------------------------
C [C] matrix
C ----------------------------------------------------------------------
$UNITS, 0, 0
C First half at the start of the windings
01X0072A                              1.E8             0.0  .0041942250555
02X0068A                               0.0             0.0-.00067873815424
                                      1.E8             0.0  .0022624605141
03X0072B                               0.0             0.0                
                                       0.0             0.0                
                                      1.E8             0.0  .0041942250555
04X0068B                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0-.00067873815424
                                      1.E8             0.0  .0022624605141
05X0072C                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                      1.E8             0.0  .0041942250555
06X0068C                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0-.00067873815424
                                      1.E8             0.0  .0022624605141
C Second half at the end of the windings
01X0072C                              1.E8             0.0  .0041942250555
02X0068A                               0.0             0.0-.00033936907712
                                      1.E8             0.0  .0022624605141
03X0072A                               0.0             0.0                
                                       0.0             0.0                
                                      1.E8             0.0  .0041942250555
04X0068B                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0-.00067873815424
                                      1.E8             0.0  .0022624605141
05X0072B                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                      1.E8             0.0  .0041942250555
06X0068C                               0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0                
                                       0.0             0.0-.00067873815424
                                      1.E8             0.0  .0022624605141
$UNITS, -1, -1
$VINTAGE, 0,
  X0071AX0072A             1.E-6                                               0
  X0071BX0072B             1.E-6                                               0
  X0071CX0072C             1.E-6                                               0
C RFA
  XX0011XX0074               10.                                               0
C RFB
  XX0012XX0074               10.                                               0
C RFC
  XX0013XX0074               10.                                               0
/SWITCH
C < n 1>< n 2>< Tclose ><Top/Tde ><   Ie   ><Vf/CLOP ><  type  >
  R1A   N100A        -1.      1.E3                                             0
  R1B   N100B        -1.      1.E3                                             0
  R1C   N100C        -1.      1.E3                                             0
C SMR1
C SMR1
  X0017AX0073A       -1.      1.E3                                             0
  X0017BX0073B       -1.      1.E3                                             0
  X0017CX0073C       -1.      1.E3                                             0
C SW3
C SW3
  N254A R11A         -1.      1.E3                                             0
  N254B R11B         -1.      1.E3                                             0
  N254C R11C         -1.      1.E3                                             0
C SW2
C SW2
  N224A R23A        100.      1.E3                                             0
  N224B R23B        100.      1.E3                                             0
  N224C R23C        100.      1.E3                                             0
C SW1
C SW1
  R9A   N324A        -1.      1.E3                                             0
  R9B   N324B        -1.      1.E3                                             0
  R9C   N324C        -1.      1.E3                                             0
  X0025AX0084A                                        MEASURING                
  X0025BX0084B                                        MEASURING                
  X0025CX0084C                                        MEASURING                
  X0084AR1A                                           MEASURING                1
  X0084BR1B                                           MEASURING                1
  X0084CR1C                                           MEASURING                1
  X0001AX0086A                                        MEASURING                
  X0001BX0086B                                        MEASURING                
  X0001CX0086C                                        MEASURING                
  X0086AR2A                                           MEASURING                1
  X0086BR2B                                           MEASURING                1
  X0086CR2C                                           MEASURING                1
  R2A   N108A        -1.      1.E3                                             0
  R2B   N108B        -1.      1.E3                                             0
  R2C   N108C        -1.      1.E3                                             0
  R3A   N208A        -1.      1.E3                                             0
  R3B   N208B        -1.      1.E3                                             0
  R3C   N208C        -1.      1.E3                                             0
  X0024AX0088A                                        MEASURING                
  X0024BX0088B                                        MEASURING                
  X0024CX0088C                                        MEASURING                
  X0088AR4A                                           MEASURING                1
  X0088BR4B                                           MEASURING                1
  X0088CR4C                                           MEASURING                1
  R4A   N112A        -1.      1.E3                                             0
  R4B   N112B        -1.      1.E3                                             0
  R4C   N112C        -1.      1.E3                                             0
  R19A  N212A        -1.      1.E3                                             0
  R19B  N212B        -1.      1.E3                                             0
  R19C  N212C        -1.      1.E3                                             0
  R5A   N312A        -1.      1.E3                                             0
  R5B   N312B        -1.      1.E3                                             0
  R5C   N312C        -1.      1.E3                                             0
  X0024AX0090A                                        MEASURING                
  X0024BX0090B                                        MEASURING                
  X0024CX0090C                                        MEASURING                
  X0090AR5A                                           MEASURING                1
  X0090BR5B                                           MEASURING                1
  X0090CR5C                                           MEASURING                1
  R6A   N116A        -1.      1.E3                                             0
  R6B   N116B        -1.      1.E3                                             0
  R6C   N116C        -1.      1.E3                                             0
  R7A   N216A        -1.      1.E3                                             0
  R7B   N216B        -1.      1.E3                                             0
  R7C   N216C        -1.      1.E3                                             0
  X0003AX0092A                                        MEASURING                
  X0003BX0092B                                        MEASURING                
  X0003CX0092C                                        MEASURING                
  X0092AR8A                                           MEASURING                1
  X0092BR8B                                           MEASURING                1
  X0092CR8C                                           MEASURING                1
  R8A   N124A        -1.      1.E3                                             0
  R8B   N124B        -1.      1.E3                                             0
  R8C   N124C        -1.      1.E3                                             0
  X0003AX0094A                                        MEASURING                
  X0003BX0094B                                        MEASURING                
  X0003CX0094C                                        MEASURING                
  X0094AR9A                                           MEASURING                1
  X0094BR9B                                           MEASURING                1
  X0094CR9C                                           MEASURING                1
  X0004AX0096A                                        MEASURING                
  X0004BX0096B                                        MEASURING                
  X0004CX0096C                                        MEASURING                
  X0096AR10A                                          MEASURING                1
  X0096BR10B                                          MEASURING                1
  X0096CR10C                                          MEASURING                1
  R10A  N154A        -1.      1.E3                                             0
  R10B  N154B        -1.      1.E3                                             0
  R10C  N154C        -1.      1.E3                                             0
  R22A  N354A        -1.      1.E3                                             0
  R22B  N354B        -1.      1.E3                                             0
  R22C  N354C        -1.      1.E3                                             0
  X0039AX0098A                                        MEASURING                
  X0039BX0098B                                        MEASURING                
  X0039CX0098C                                        MEASURING                
  X0098AR22A                                          MEASURING                1
  X0098BR22B                                          MEASURING                1
  X0098CR22C                                          MEASURING                1
  X0004AX0100A                                        MEASURING                
  X0004BX0100B                                        MEASURING                
  X0004CX0100C                                        MEASURING                
  X0100AR11A                                          MEASURING                1
  X0100BR11B                                          MEASURING                1
  X0100CR11C                                          MEASURING                1
  R12A  N358A        -1.      1.E3                                             0
  R12B  N358B        -1.      1.E3                                             0
  R12C  N358C        -1.      1.E3                                             0
  X0005AX0102A                                        MEASURING                
  X0005BX0102B                                        MEASURING                
  X0005CX0102C                                        MEASURING                
  X0102AR12A                                          MEASURING                1
  X0102BR12B                                          MEASURING                1
  X0102CR12C                                          MEASURING                1
  R13A  N258A        -1.      1.E3                                             0
  R13B  N258B        -1.      1.E3                                             0
  R13C  N258C        -1.      1.E3                                             0
  X0005AX0104A                                        MEASURING                
  X0005BX0104B                                        MEASURING                
  X0005CX0104C                                        MEASURING                
  X0104AR13A                                          MEASURING                1
  X0104BR13B                                          MEASURING                1
  X0104CR13C                                          MEASURING                1
  X0017AX0106A                                        MEASURING                
  X0017BX0106B                                        MEASURING                
  X0017CX0106C                                        MEASURING                
  X0106AR14A                                          MEASURING                1
  X0106BR14B                                          MEASURING                1
  X0106CR14C                                          MEASURING                1
  R14A  N134A        -1.      1.E3                                             0
  R14B  N134B        -1.      1.E3                                             0
  R14C  N134C        -1.      1.E3                                             0
  R21A  N234A        -1.      1.E3                                             0
  R21B  N234B        -1.      1.E3                                             0
  R21C  N234C        -1.      1.E3                                             0
  X0017AX0108A                                        MEASURING                
  X0017BX0108B                                        MEASURING                
  X0017CX0108C                                        MEASURING                
  X0108AR21A                                          MEASURING                1
  X0108BR21B                                          MEASURING                1
  X0108CR21C                                          MEASURING                1
  X0073AX0110A                                        MEASURING                
  X0073BX0110B                                        MEASURING                
  X0073CX0110C                                        MEASURING                
  X0110AR15A                                          MEASURING                1
  X0110BR15B                                          MEASURING                1
  X0110CR15C                                          MEASURING                1
  X0018AX0112A                                        MEASURING                
  X0018BX0112B                                        MEASURING                
  X0018CX0112C                                        MEASURING                
  X0112AR16A                                          MEASURING                1
  X0112BR16B                                          MEASURING                1
  X0112CR16C                                          MEASURING                1
  R16A  N136A        -1.      1.E3                                             0
  R16B  N136B        -1.      1.E3                                             0
  R16C  N136C        -1.      1.E3                                             0
  R17A  N236A        -1.      1.E3                                             0
  R17B  N236B        -1.      1.E3                                             0
  R17C  N236C        -1.      1.E3                                             0
  X0018AX0114A                                        MEASURING                
  X0018BX0114B                                        MEASURING                
  X0018CX0114C                                        MEASURING                
  X0114AR17A                                          MEASURING                1
  X0114BR17B                                          MEASURING                1
  X0114CR17C                                          MEASURING                1
  X0069AX0073A       -1.      1.E3                                             0
  X0069BX0073B       -1.      1.E3                                             0
  X0069CX0073C       -1.      1.E3                                             0
  X0061AX0116A                                        MEASURING                
  X0061BX0116B                                        MEASURING                
  X0061CX0116C                                        MEASURING                
  X0116AR18A                                          MEASURING                1
  X0116BR18B                                          MEASURING                1
  X0116CR18C                                          MEASURING                1
  R18A  N866A        -1.      1.E3                                             0
  R18B  N866B        -1.      1.E3                                             0
  R18C  N866C        -1.      1.E3                                             0
  X0003AX0118A                                        MEASURING                
  X0003BX0118B                                        MEASURING                
  X0003CX0118C                                        MEASURING                
  X0118AR23A                                          MEASURING                1
  X0118BR23B                                          MEASURING                1
  X0118CR23C                                          MEASURING                1
  X0005AX0120A                                        MEASURING                
  X0005BX0120B                                        MEASURING                
  X0005CX0120C                                        MEASURING                
  X0120AR24A                                          MEASURING                1
  X0120BR24B                                          MEASURING                1
  X0120CR24C                                          MEASURING                1
  R24A  N158A        -1.      1.E3                                             0
  R24B  N158B        -1.      1.E3                                             0
  R24C  N158C        -1.      1.E3                                             0
  R25A  N336A        -1.      1.E3                                             0
  R25B  N336B        -1.      1.E3                                             0
  R25C  N336C        -1.      1.E3                                             0
  X0018AX0122A                                        MEASURING                
  X0018BX0122B                                        MEASURING                
  X0018CX0122C                                        MEASURING                
  X0122AR25A                                          MEASURING                1
  X0122BR25B                                          MEASURING                1
  X0122CR25C                                          MEASURING                1
  X0002AX0124A                                        MEASURING                
  X0002BX0124B                                        MEASURING                
  X0002CX0124C                                        MEASURING                
  X0124AR7A                                           MEASURING                1
  X0124BR7B                                           MEASURING                1
  X0124CR7C                                           MEASURING                1
  X0002AX0126A                                        MEASURING                
  X0002BX0126B                                        MEASURING                
  X0002CX0126C                                        MEASURING                
  X0126AR6A                                           MEASURING                1
  X0126BR6B                                           MEASURING                1
  X0126CR6C                                           MEASURING                1
  X0056AX0128A                                        MEASURING                
  X0056BX0128B                                        MEASURING                
  X0056CX0128C                                        MEASURING                
  X0128AR20A                                          MEASURING                1
  X0128BR20B                                          MEASURING                1
  X0128CR20C                                          MEASURING                1
  R20A  N867A        -1.      1.E3                                             0
  R20B  N867B        -1.      1.E3                                             0
  R20C  N867C        -1.      1.E3                                             0
  X0130AX0030A                                        MEASURING                0
  X0130BX0030B                                        MEASURING                0
  X0130CX0030C                                        MEASURING                0
  X0028AX0132A                                        MEASURING                0
  X0028BX0132B                                        MEASURING                0
  X0028CX0132C                                        MEASURING                0
  X0141AX0040A                                        MEASURING                0
  X0141BX0040B                                        MEASURING                0
  X0141CX0040C                                        MEASURING                0
  X0037AX0143A                                        MEASURING                0
  X0037BX0143B                                        MEASURING                0
  X0037CX0143C                                        MEASURING                0
  X0040AX0045A                                        MEASURING                1
  X0040BX0045B                                        MEASURING                1
  X0040CX0045C                                        MEASURING                1
  X0152AX0050A                                        MEASURING                0
  X0152BX0050B                                        MEASURING                0
  X0152CX0050C                                        MEASURING                0
  X0048AX0154A                                        MEASURING                0
  X0048BX0154B                                        MEASURING                0
  X0048CX0154C                                        MEASURING                0
  X0050AX0055A                                        MEASURING                1
  X0050BX0055B                                        MEASURING                1
  X0050CX0055C                                        MEASURING                1
  X0163AX0062A                                        MEASURING                0
  X0163BX0062B                                        MEASURING                0
  X0163CX0062C                                        MEASURING                0
  X0059AX0165A                                        MEASURING                0
  X0059BX0165B                                        MEASURING                0
  X0059CX0165C                                        MEASURING                0
  X0062AX0067A                                        MEASURING                1
  X0062BX0067B                                        MEASURING                1
  X0062CX0067C                                        MEASURING                1
  X0068AX0069A                                        MEASURING                1
  X0068BX0069B                                        MEASURING                1
  X0068CX0069C                                        MEASURING                1
  X0010AX0174A                                        MEASURING                
  X0010BX0174B                                        MEASURING                
  X0010CX0174C                                        MEASURING                
  X0174AR19A                                          MEASURING                1
  X0174BR19B                                          MEASURING                1
  X0174CR19C                                          MEASURING                1
C FaultSwC
C FaultSwC
  X0006CXX0011      1.E3       -1.                                             0
C FaultSwB
C FaultSwB
  X0006BXX0012      1.E3       -1.                                             0
C FaultSwA
C FaultSwA
  X0006AXX0013      1.E3       -1.                                             0
C FaultSwGround
C FaultSwGround
  XX0074            1.E3       -1.                                             0
  X0001AX0176A                                        MEASURING                
  X0001BX0176B                                        MEASURING                
  X0001CX0176C                                        MEASURING                
  X0176AR3A                                           MEASURING                1
  X0176BR3B                                           MEASURING                1
  X0176CR3C                                           MEASURING                1
  N334A R15A         -1.      1.E3                                             0
  N334B R15B         -1.      1.E3                                             0
  N334C R15C         -1.      1.E3                                             0
/SOURCE
C < n 1><>< Ampl.  >< Freq.  ><Phase/T0><   A1   ><   T1   >< TSTART >< TSTOP  >
14N814A       1.E-20       60.                                     -1.       10.
18              .925X0007A      
14N814B       1.E-20       60.                                     -1.       10.
18            .96875X0007B      
14N814C       1.E-20       60.                                     -1.       10.
18            .96875X0007C      
14N852A       1.E-20       60.                                     -1.       10.
18            .91875X0008A      
14N852B       1.E-20       60.                                     -1.       10.
18            .93125X0008B      
14N852C       1.E-20       60.                                     -1.       10.
18              .925X0008C      
60X0029A 0                                                                  1.E3
60X0029B 0                                                                  1.E3
60X0029C 0                                                                  1.E3
14X0030A      1.E-20       60.                                     -1.       10.
18        .016068447X0010A      
14X0030B      1.E-20       60.                                     -1.       10.
18        .016068447X0010B      
14X0030C      1.E-20       60.                                     -1.       10.
18        .016068447X0010C      
60X0038A 0                                                                  1.E3
60X0038B 0                                                                  1.E3
60X0038C 0                                                                  1.E3
14X0045A      1.E-20       60.                                     -1.       10.
18        .016068447X0039A      
14X0045B      1.E-20       60.                                     -1.       10.
18        .016068447X0039B      
14X0045C      1.E-20       60.                                     -1.       10.
18        .016068447X0039C      
60X0049A 0                                                                  1.E3
60X0049B 0                                                                  1.E3
60X0049C 0                                                                  1.E3
14X0055A      1.E-20       60.                                     -1.       10.
18        .016068447X0056A      
14X0055B      1.E-20       60.                                     -1.       10.
18        .016068447X0056B      
14X0055C      1.E-20       60.                                     -1.       10.
18        .016068447X0056C      
60X0060A 0                                                                  1.E3
60X0060B 0                                                                  1.E3
60X0060C 0                                                                  1.E3
14X0067A      1.E-20       60.                                     -1.       10.
18        .016068447X0061A      
14X0067B      1.E-20       60.                                     -1.       10.
18        .016068447X0061B      
14X0067C      1.E-20       60.                                     -1.       10.
18        .016068447X0061C      
C mainSource
14X0070A  56338.2641       60.      130.                           -1.      100.
14X0070B  56338.2641       60.       10.                           -1.      100.
14X0070C  56338.2641       60.     -110.                           -1.      100.
C microGridSource
59X0071A        330.       60.      130.
  X0071B
  X0071C
PARAMETER FITTING             2.
 1 1  1  4        1.        1.       .36       .38      100.
BLANK
      .013       .07      2.38       1.1      .264       .38      .201      .376
      2.47       .09      .018      .009      .074                           .07
 1               1.0     3.123                                        
BLANK
  11
  21
  31
  41
  51
BLANK
  FINISH
/OUTPUT
  R1A   R1B   R1C   R2A   R2B   R2C   R4A   R4B   R4C   R5A   R5B   R5C   R8A   
  R8B   R8C   R9A   R9B   R9C   R10A  R10B  R10C  R22A  R22B  R22C  R11A  R11B  
  R11C  R12A  R12B  R12C  R13A  R13B  R13C  R14A  R14B  R14C  R21A  R21B  R21C  
  R15A  R15B  R15C  R16A  R16B  R16C  R17A  R17B  R17C  R18A  R18B  R18C  R23A  
  R23B  R23C  R24A  R24B  R24C  R25A  R25B  R25C  R7A   R7B   R7C   R6A   R6B   
  R6C   R20A  R20B  R20C  X0040AX0040BX0040CX0039AX0055AX0055BX0055CX0067AX0067B
  X0067CX0071AX0071BX0071CX0069AX0069BX0069CX0070AX0070BX0070CR19A  R19B  R19C  
  R3A   R3B   R3C   
BLANK TACS
BLANK MODELS
BLANK BRANCH
BLANK SWITCH
BLANK SOURCE
BLANK OUTPUT
BLANK PLOT
BEGIN NEW DATA CASE
BLANK
